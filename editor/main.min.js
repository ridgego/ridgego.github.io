(()=>{var e,t={11310:(e,t,n)=>{"use strict";var i=n(1892),o=n.n(i),s=n(95760),r=n.n(s),a=n(38311),l=n.n(a),c=n(58192),d=n.n(c),p=n(38060),h=n.n(p),m=n(54865),g=n.n(m),u=n(72801),f={};f.styleTagTransform=g(),f.setAttributes=d(),f.insert=l().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=h(),o()(u.Z,f),u.Z&&u.Z.locals&&u.Z.locals,n(50796);var b=n(27378),v=n(37634),y=n(11259),w=n(31542),x=n(8731),C={};C.styleTagTransform=g(),C.setAttributes=d(),C.insert=l().bind(null,"head"),C.domAPI=r(),C.insertStyleElement=h(),o()(x.Z,C),x.Z&&x.Z.locals&&x.Z.locals;var E=n(86947);const k=e=>new E.ZP(document.body,Object.assign({dimensionViewable:!0,deleteButtonViewable:!1,container:document.body,snappable:!1,snapGap:!1,isDisplayInnerSnapDigit:!1,draggable:!0,resizable:!0,scalable:!1,rotatable:!1,warpable:!1,pinchable:!1,origin:!0,keepRatio:!1,edge:!1,throttleDrag:0,throttleResize:1,throttleScale:0,throttleRotate:0,clipTargetBounds:!0},e));var S=n(98268),P=n(44426),z={};z.styleTagTransform=g(),z.setAttributes=d(),z.insert=l().bind(null,"head"),z.domAPI=r(),z.insertStyleElement=h(),o()(P.Z,z),P.Z&&P.Z.locals&&P.Z.locals;const{Text:F}=y.Typography,N=b.createContext("light");class L extends b.Component{constructor(){super(),this.ref=b.createRef(),this.state={state:"normal",errors:null,openSearch:!1,search:null,hasError:!1}}static getDerivedStateFromError(e){return{errors:e,hasError:!0}}componentDidMount(){this.enablePanelMoveResize()}enablePanelMoveResize(){const e=k({className:"workspace-movable",target:this.ref.current,dragTarget:this.ref.current.querySelector(".title-bar .icon-handle")});e.on("resize",(({target:e,width:t,height:n,delta:i,transform:o})=>{e.style.transform=o,i[0]&&(e.style.width=`${t}px`),i[1]&&(e.style.height=`${n}px`)})),e.on("drag",(e=>{e.target.style.transform=e.transform,Array.from(document.querySelectorAll(".movable-panel")).forEach((e=>{e.style.zIndex=300})),this.ref.current.style.zIndex=301}))}render(){const{onClose:e,position:t,visible:n,title:i,padding:o="0",className:s="default-panel"}=this.props,{state:r,openSearch:a,search:l}=this.state,c={};if(Array.isArray(t)&&6===t.length){const[e,n,i,o,s,r]=t;e&&(c.left=e+"px"),n&&(c.top=n+"px"),i&&(c.right=i+"px"),o&&(c.bottom=o+"px"),s&&(c.width=s+"px"),r&&(c.height=r+"px")}n||(c.display="none");const d=["movable-panel",s];return a&&d.push("open-search"),w.createPortal(b.createElement("div",{ref:this.ref,className:d.join(" "),style:c,id:this.props.id},b.createElement("div",{className:"title-bar",style:{}},b.createElement(S.Z,{className:"icon-handle"}),i&&b.createElement(F,{className:"title-text"},i)),b.createElement("div",{className:"panel-content",style:{}},this.state.hasError?b.createElement("div",null,"Something went wrong. ",JSON.stringify(this.state)):b.createElement(N.Provider,{value:l},this.props.children))),document.body)}}var O=n(67124);const j=({value:e,options:t,onChange:n})=>b.createElement(y.J2,{showArrow:!0,trigger:"click",content:b.createElement(b.Fragment,null,b.createElement(y.zx,{size:"small",onClick:()=>{n(null)}},"清除颜色"),b.createElement(O.xS,{color:e||"#fff",width:220,style:{boxShadow:"none"},triangle:"hide",onChange:e=>{n(e.hex+parseInt(255*e.rgb.a).toString(16))},onChangeComplete:e=>{n(e.hex+parseInt(255*e.rgb.a).toString(16))}}))},b.createElement(y.zx,{size:"small",style:{backgroundColor:e,height:"22px",width:"22px",margin:"0 3px",padding:0,border:"1px solid #ccc"}})),T=(0,y.Q2)(j),D=(0,y.Q2)((({value:e,onChange:t})=>{const[n="",i="solid",o="#ccc"]=(e||"").split(" ");return b.createElement(y.T,null,b.createElement(y.Rn,{style:{width:60},size:"small",value:parseInt(n)||0,onChange:e=>{t(`${e}px ${i} ${o}`)}}),b.createElement(y.Select,{size:"small",value:i,onChange:e=>{t(`${n} ${e} ${o}`)}},b.createElement(y.Select.Option,{value:"solid"},"实线"),b.createElement(y.Select.Option,{value:"dashed"},"点划线")),b.createElement(j,{value:o,onChange:e=>{t(`${n} ${i} ${e}`)}}))}));var A=n(92450),M=n(98784),R=n(96292),I=n.n(R),Z=n(45047),V={};V.styleTagTransform=g(),V.setAttributes=d(),V.insert=l().bind(null,"head"),V.domAPI=r(),V.insertStyleElement=h(),o()(Z.Z,V),Z.Z&&Z.Z.locals&&Z.Z.locals;var B=n(49601),U={};U.styleTagTransform=g(),U.setAttributes=d(),U.insert=l().bind(null,"head"),U.domAPI=r(),U.insertStyleElement=h(),o()(B.Z,U),B.Z&&B.Z.locals&&B.Z.locals;var _=n(23240),q=n(96051),J=n.n(q),$=n(16651),H=n.n($);const W={react:["react/umd/react.production.min.js","react-dom/umd/react-dom.production.min.js"],axios:["axios/dist/axios.min.js"],lodash:["lodash/lodash.min.js"]},K=I()("ridge:loader"),Y=class{constructor({baseUrl:e}){this.baseUrl=e,K("RidgeLoader baseUrl: "+this.baseUrl),this.loadedFonts=[],this.getPackageJSON=H()(this._getPackageJSON),this.loadComponent=H()(this._loadComponent),this.loadScript=H()(this._loadScript)}getComponentUrl({packageName:e,path:t}){return`${this.baseUrl}/${e}/${t}`}getPackageJSONUrl(e){return`${this.baseUrl}/${e}/package.json`}async _loadComponent(e){let t,n;if("object"==typeof e)t=e.packageName,n=e.path;else{const i=e.split("/");i[0].startsWith("@")?(t=i.splice(0,2).join("/"),n=i.join("/")):(t=i.splice(0,1).join("/"),n=i.join("/"))}return await this.doLoadComponent({packageName:t,path:n})}async doLoadComponent({packageName:e,path:t}){const n=await this.getPackageJSON(e);if(null==n)return null;await this.confirmPackageDependencies(n);const i=await this.loadComponentScript({packageName:e,path:t});return i&&await this.prepareComponent(i,{packageName:e,path:t},n),i}async prepareComponent(e,{packageName:t,path:n},i){e.packageName=t,e.path=n,e.title=e.title||e.label,e.requires&&e.requires.length&&await this.loadExternals(e.requires),"react"===e.type&&(await this.loadScript(`${this.baseUrl}/react/umd/react.production.min.js`),await this.loadScript(`${this.baseUrl}/react-dom/umd/react-dom.production.min.js`)),e.component?"function"==typeof e.component&&"AsyncFunction"===e.component.constructor.name&&(e.component=(await e.component()).default):K("组件 Component定义未加载到",e)}on(e,t){this.eventCallbacks.push({eventName:e,callback:t})}async loadComponentScript({packageName:e,path:t}){await this.loadScript(`${this.baseUrl}/${e}/build/${t}.js`);const n=`${e}/${t}`;return window[n]?window[n].default:null}getComponent(e){return this.componentCache[e]?this.componentCache[e]:null}async loadCss(e){const t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.getElementsByTagName("HEAD")[0].appendChild(t)}async _loadScript(e){if(null!=e)try{const t=e.replace(/\/\//g,"/");return K("加载库:"+t),await J()(t,{returnPromise:!0,before:function(e,t){t.crossOrigin=!0}}),t}catch(t){console.error("JS Load Error:",`${e}`)}}async _getPackageJSON(e){const t=this.getPackageJSONUrl(e);try{return await _.Z.get(t).json()}catch(e){return K("NPM Package Not Loaded:",t),null}}async confirmPackageDependencies(e){if(await this.loadFrameworkDep(e),e.externals)for(const t of e.externals)await this.loadScript(`${this.baseUrl}/${e.name}/${t}`)}async loadFrameworkDep(e){if(e.dependencies)for(const t of Object.keys(e.dependencies))if(W[t])for(const e of W[t])await this.loadScript(`${this.baseUrl}/${e}`)}async loadJSON(e){return await _.Z.get(e).json()}};var G=n(76005);const X=I()("ridge:store"),Q=I()("ridge:store-error");class ee{constructor(e){this.module=e,this.watchers={},this.state={},this.context={setState:e=>{Object.assign(this.state,e)}},this.scheduledJobs=new Set}getContext(e={}){return Object.assign(this.context,{properties:this.properties,state:this.state,...this.module.actions??{},...e})}initStore(e){if(this.properties=e,this.context.properties=e,this.module){if("function"==typeof this.module.state)try{this.state=(0,G.sj)(this.module.state(e))}catch(e){console.error("initializeModule Error",e)}else"object"==typeof this.module.state&&(this.state=(0,G.sj)(this.module.state.state));this.context.state=this.state,Object.assign(this.context,this.module.actions??{}),this.module.setup&&this.module.setup.call(this.context),this.state&&(0,G.Ld)(this.state,(e=>{this.onMutations(e)})),this.flushScheduledJobs()}}updateProps(e){this.properties=e,this.module.propsUpdate&&this.module.propsUpdate(e)}subscribe(e,t,n){const i=t.join(".");switch(e){case"state":this.addWatchers(i,n);break;case"computed":if(this.module.computed&&this.module.computed[i]&&Array.isArray(this.module.computed[i].dependencies))for(const e of this.module.computed[i].dependencies)this.addWatchers(e,n)}}addWatchers(e,t){null==this.watchers[e]&&(this.watchers[e]=new Set),this.watchers[e].add(t)}getValue(e,t,n){let i=null;if("state"===e)i=(0,M.get)(this.state,t);else if("computed"===e){const e=this.module.computed[t];e&&("function"==typeof e?i=e.apply(this.context,[this.state,...n]):"function"==typeof e.get&&(i=e.get.apply(this.context,[this.state,...n])))}return i}dispatchChange(e,t,n,...i){if("state"===e)(0,M.set)(this.state,t.split("."),n);else if("computed"===e&&this.module.computed&&"function"==typeof this.module.computed[t]?.set)try{this.module.computed[t]?.set.call(this,n,this.state,...i)}catch(e){Q("dispatchChange Error",e)}}doStoreAction(e,{scopedData:t,payload:n,eventArgs:i}){if(this.module.actions&&this.module.actions[e])try{const o=this.module.actions[e].call(this.context,i,{scope:(t??[])[0],scopes:t,payload:n});"object"==typeof o&&Object.assign(this.state,o)}catch(e){console.error("doStoreAction Error",e)}}onMutations(e){for(const t of e){const[e,n,i,o]=t;X("mutation",e,n.join("."),i,o),this.onStateChange(n,i,o)}this.flushScheduledJobs()}onStateChange(e,t,n){const i=e.join(".");this.module.watch&&this.module.watch[i]&&this.module.watch[i].call(this.context,t,n);const o=[];let s="";for(let t=0;t<e.length;t++)s=e.slice(0,t+1).join("."),this.watchers[s]&&o.push(...this.watchers[s]);this.scheduleCallback(o)}scheduleCallback(e){for(const t of e)this.scheduledJobs.add(t)}flushScheduledJobs(){for(const e of this.scheduledJobs)try{e()}catch(e){console.error("job exec error",e)}this.scheduledJobs.clear()}destory(){this.module.destory&&this.module.destory(this.getContext())}}const te=I()("ridge:store");I()("ridge:store-error");class ne{constructor(e){this.composite=e,this.properties=e.properties,this.storeObjects={}}setProperties(e){this.properties=e;for(const t of Object.values(this.storeObjects))t.updateProps(e)}load(e,t){for(const n of Array.isArray(e)?e:[e])this.registerPageStore(n,t)}getStoreValue(e,t){const[n,i,...o]=e.split(".");if(this.storeObjects[n])return this.storeObjects[n].getValue(i,o.join("."),t)}subscribe(e,t){if(e)try{const[n,i,...o]=e.split(".");te("subscribe",e),this.storeObjects[n]&&this.storeObjects[n].subscribe(i,o,t)}catch(t){console.error("subscribe error",e,t)}}dispatchChange(e,t,n){const[i,o,...s]=e.split(".");this.storeObjects[i]&&this.storeObjects[i].dispatchChange(o,s.join("."),t,n)}doStoreAction(e,t,n){this.storeObjects[e]&&this.storeObjects[e].doStoreAction(t,n)}registerPageStore(e,t){if(te("RegisterPageStore",e),!e.name)return void te("Store Not Registered: No Name");const n=e.name;this.storeObjects[n]=new ee(e),this.storeObjects[n].initStore(t)}destory(){for(const e of Object.values(this.storeObjects))e.destory()}}class ie{async mount(){}setOption(e){}updateProps(e){}layout(e){}invoke(e,t){}on(e,t){}destroy(){}}class oe extends ie{constructor(e,t={}){super(),this.JSXComponent=e,this.props=t,this.props.ref||(this.props.ref=React.createRef()),this.renderRef=this.props.ref}mount(e){this.el=e,this.root=ReactDOM.createRoot(e),this.root.render(this.getRenderInstance())}getRenderInstance(){return React.createElement(this.JSXComponent,this.props)}on(e,t){Object.assign(this.props,{[e]:t}),this.root.render(React.createElement(this.JSXComponent,this.props),this.el)}invoke(e,t){if(this.renderRef&&this.renderRef.current&&this.renderRef.current[e]&&"function"==typeof this.renderRef.current[e])return this.renderRef.current[e](...t||[])}hasMethod(e){return this.renderRef&&this.renderRef.current&&this.renderRef.current[e]&&"function"==typeof this.renderRef.current[e]}setOption(e){this.updateProps(e)}updateProps(e){this.props=e,this.renderRef&&this.renderRef.current&&"function"==typeof this.renderRef.current.updateProps?this.renderRef.current.updateProps(e):this.root.render(this.getRenderInstance(),this.el)}layout(e){ReactDOM.render(React.createElement(this.JSXComponent,e),this.el)}destroy(){ReactDOM.unmountComponentAtNode(this.el),this.renderRef&&(this.renderRef=null)}}class se extends ie{constructor(e,t={}){super(),this.VannilaComponent=e,this.props=t}mount(e){this.el=e,this.getRenderInstance().mount(e)}getRenderInstance(){return this.instance||(this.instance=new this.VannilaComponent(this.props)),this.instance}on(e,t){this.instance.on(e,t)}invoke(e,t){if(this.getRenderInstance()[e])return this.getRenderInstance()[e].apply(this.getRenderInstance(),t)}hasMethod(e){return null!=this.getRenderInstance()[e]}setOption(e){this.updateProps(e)}updateProps(e){this.getRenderInstance().update(e)}layout(e){this.getRenderInstance().layout(e)}destroy(){this.instance&&(this.instance.destroy&&this.instance.destroy(),this.instance=null)}}class re extends ie{constructor(e){super(),this.options=e}mount(e){this.el=e,this.el.innerHTML=`<div class="store-component"><i class="bi bi-sliders"></i><div class="store-name">${this.options.title??this.options.name}</div></div>`}update({title:e}){this.el.innerHTML=`<div class="store-component"><i class="bi bi-sliders"></i><div class="store-name">${e}</div></div>`}}var ae=n(72155),le=(n(97429),n(55663)),ce=n.n(le);const de=(0,ae.kP)("1234567890abcdefghijklmnopqrstuvwxyz",10),pe=class{async load(){}async mount(e){}setProperties(e){}unmount(){}invoke(){}setStatus(e,t){if(this.status=e,!this.el)return;const n=this.el.querySelectorAll(".ridge-overlay");for(const e of n)e.parentElement.removeChild(e);const i=document.createElement("div");i.setAttribute("name",e),i.classList.add("ridge-overlay"),i.classList.add("status-"+e),t&&(i.textContent=t),this.el.appendChild(i)}getStatus(){return this.status}removeStatus(e){if(this.status=null,!this.el)return;const t=this.el.querySelectorAll(".ridge-overlay");for(const n of t)e?n.classList.contains("status-"+e)&&n.parentElement.removeChild(n):n.parentElement.removeChild(n)}},he=I()("ridge:element");class me extends pe{constructor({config:e,composite:t,componentDefinition:n}){super(),this.uuid="ins-"+de(8),this.config=e,this.composite=t,this.componentDefinition=n,this.properties={},this.events={}}isRoot(){return null==this.config.parent}getId(){return this.config.id}getProperties(){return Object.assign({},this.config.props,this.events,this.properties,{children:this.children})}getConfig(){return this.config}getEl(){return this.el}getParent(){return this.parent}getScopedData(){const e=this.getParent(),t=e?e.getScopedData():[];return null==this.scopedData?t:[this.scopedData,...t]}setScopedData(e){this.scopedData=e}async load(){this.componentDefinition||(this.setStatus("loading"),this.config.path&&(this.componentDefinition=await this.composite.context.loadComponent(this.config.path)),this.componentDefinition?this.removeStatus("loading"):this.setStatus("not-found"))}async mount(e){this.el=e,this.el.ridgeNode=this,this.el.setAttribute("component",this.config.path),this.el.setAttribute("ridge-id",this.config.id),this.el.classList.add("ridge-element"),this.style=Object.assign({},this.config.style),this.updateConnectedStyle(),this.updateStyle(),this.updateConnectedProperties(),this.initializeEvents(),this.initSubscription(),this.componentDefinition||await this.load(),null!=this.componentDefinition&&(this.updateSystemProperties(),this.renderer=this.createRenderer(),this.mounted&&this.mounted())}initChildren(){if(this.config.props.children&&null==this.children){this.children=[];for(const e of this.config.props.children){const t=this.composite.getNode(e);t&&(t.parent=this,t.initChildren(),this.children.push(t))}}}initializeEvents(){this.config.propEx.value&&(this.events.input=e=>{this.composite.store.dispatchChange(this.config.propEx.value,e,...this.getScopedData())});for(const[e,t]of Object.entries(this.config.events??{}))this.events[e]=(...e)=>{for(const n of t)if(n.store&&n.method){const t={payload:e,scopedData:this.getScopedData(),eventArgs:n.payload};this.composite.store.doStoreAction(n.store,n.method,t)}}}initSubscription(){Object.values(this.config.styleEx).forEach((e=>{this.composite.store?.subscribe&&this.composite.store.subscribe(e,(()=>{this.forceUpdateStyle()}))})),Object.values(this.config.propEx).forEach((e=>{this.composite.store?.subscribe&&this.composite.store.subscribe(e,(()=>{this.forceUpdateProperty()}))}))}createRenderer(){try{if("vanilla"===this.componentDefinition.type){const e=new se(this.componentDefinition.component,this.getProperties());return e.mount(this.el),this.removeStatus(),e}if("store"===this.componentDefinition.type||"style"===this.componentDefinition.type||"script"===this.componentDefinition.type){this.el.classList.add("is-store");const e=new re({title:this.config.title});return e.mount(this.el),this.removeStatus(),e}{const e=new oe(this.componentDefinition.component,this.getProperties());return e.mount(this.el),this.removeStatus(),e}}catch(e){this.setStatus("render-error"),console.error("组件初始化渲染异常",this.componentDefinition,e)}return null}forceUpdateStyle(){this.updateConnectedStyle(),this.updateStyle()}forceUpdateProperty(){this.updateConnectedProperties(),this.updateProps()}forceUpdate(){this.forceUpdateStyle(),this.forceUpdateProperty()}updateProps(e){if(e&&Object.assign(this.properties,e),this.renderer){const e=this.getProperties();try{he("updateProps",this.config.id,e),this.renderer.updateProps(this.getProperties())}catch(t){he("Render Error:",t,this,e)}}else he("updateProps umounted",this.id)}updateConnectedStyle(){if(this.composite.store)for(const e of Object.keys(this.config.styleEx||{}))null!=this.config.styleEx[e]&&""!==this.config.styleEx[e]&&(this.style[e]=this.composite.store.getStoreValue(this.config.styleEx[e],this.getScopedData()))}updateChildStyle(e){this.invoke("updateChildStyle",[e])}updateStyle(){this.el&&(!1===this.config.visible?this.el.classList.add("ridge-is-hidden"):!0===this.config.visible&&this.el.classList.remove("ridge-is-hidden")),this.parent&&this.parent.updateChildStyle(this),this.invoke("onStyleUpdated",[this])}updateConnectedProperties(){if(this.composite.store)for(const[e,t]of Object.entries(this.config.propEx))if(null!=t&&""!==t)try{this.properties[e]=this.composite.store.getStoreValue(t,this.getScopedData())}catch(e){console.error("get Store Value Error: ",e)}}updateSystemProperties(){if(this.componentDefinition){if(this.componentDefinition.props){const e=this.componentDefinition.props.filter((e=>"image"===e.type));if(e.length)for(const t of e)this.config.props[t.name]&&(this.properties[t.name]=this.getBlobUrl(this.config.props[t.name]))}if(this.componentDefinition.requiredProperties)for(const e of this.componentDefinition.requiredProperties)switch(e){case"ridge":this.properties.ridge=this.composite.context;break;case"composite":this.properties.composite=this.composite;break;case"element":this.properties.composite=this}}}getBlobUrl(e){return this.composite.appBaseUrl+e}emit(e,t){if(this.composite.store)if(he("Emit Event:",e,t),"input"!==e||this.config.events[e]){if(this.config.events[e])for(const n of this.config.events[e])n.store&&n.method&&this.composite.store.doStoreAction(n.store,n.method,[...t,n.payload,...this.getScopedData()])}else this.config.propEx.value&&this.composite.store.dispatchChange(this.config.propEx.value,[t,...this.getScopedData()])}clone(){const e=new me({composite:this.composite,componentDefinition:this.componentDefinition,config:this.config});if(this.children){e.children=[];for(const t of this.children){const n=t.clone();n.parent=e,e.children.push(n)}}return e.parent=this.parent,e}invoke(e,t){if(this.renderer)return this.renderer.invoke(e,t)}hasMethod(e){return!!this.renderer&&this.renderer.hasMethod(e)}unmount(){this.renderer&&(this.renderer.destroy(),this.renderer=null),this.el&&this.el.parentElement&&this.el.parentElement.removeChild(this.el),this.el=null}}const ge=me,ue=I()("ridge:manager"),fe=class extends pe{constructor({el:e,appBaseUrl:t,config:n,properties:i,context:o}){super(),this.config=n,this.context=o,this.appBaseUrl=t,this.el=e,this.properties=i,this.initialize()}initialize(){ue("Ridge Composite initialize:",this.config),this.nodes={};for(let e=0;e<this.config.elements.length;e++){const t=this.createElement(this.config.elements[e]);this.nodes[t.getId()]=t}this.initChildren(),this.events={},this.classList=new Set}async load(){const e=[];await Promise.allSettled(e);for(const t of Object.values(this.nodes))e.push(await t.load());await Promise.allSettled(e)}getNodes(e){const t=Object.values(this.nodes);return e?t.filter(e):t}getRootNodes(){return Object.values(this.nodes).filter((e=>e.isRoot()))}getNode(e){return this.nodes[e]}initChildren(){this.config.children?this.children=this.config.children.map((e=>this.nodes[e])):this.children=Object.values(this.nodes).filter((e=>null==e.config.parent));for(const e of this.children)e.parent=this,e.initChildren()}createElement(e){return new ge({composite:this,config:e})}async mount(e){if(e){this.el=e;for(const e of this.el.classList)this.classList.add(e)}this.emit("postMount"),this.updateStyle(),this.onPageMounted&&this.onPageMounted(),this.jsModules=await this.importJSFiles(),await this.importStyleFiles(),await this.loadStore();const t=[];for(const e of this.children){const n=document.createElement("div");this.el.appendChild(n),t.push(await e.mount(n))}await Promise.allSettled(t),this.onPageLoaded&&this.onPageLoaded(),this.initializeEvents(),this.emit("loaded")}unmount(){for(const e of this.children)e.unmount();this.store&&this.store.destory()}updateStyle(){if(this.el.classList.add("ridge-composite"),this.config.style&&this.el){this.el.style.background="";const{background:e,classNames:t=[]}=this.config.style;e&&Object.assign(this.el.style,{background:e}),t&&t.forEach((e=>{this.el.classList.add(e)}))}}updateChildStyle(e){if(e.el)if(e.config.full)e.el.classList.add("ridge-is-full"),e.el.style.transform="none",e.el.style.width="",e.el.style.height="";else{const t=e.config.style;e.el.classList.remove("ridge-is-full"),e.el.style.position="absolute",e.el.style.left=0,e.el.style.top=0,e.el.style.transform=`translate(${t.x}px, ${t.y}px)`,e.el.style.width=t.width?t.width+"px":"",e.el.style.height=t.height?t.height+"px":""}}getScopedData(){return[]}async importStyleFiles(){const{cssFiles:e}=this.config;for(const t of e??[])await this.context.loadScript(this.appBaseUrl+"/"+t)}async importJSFiles(){const{jsFiles:e}=this.config,t=[];for(const n of e??[]){const e=await this.loadModule(this.appBaseUrl+"/"+n);e&&t.push(e)}return t}async loadModule(e){const t="resolve-"+de(5),n=document.createElement("script");return n.setAttribute("type","module"),n.setAttribute("async",!0),document.head.append(n),n.textContent=`import * as Module from '${e}'; window['${t}'](Module);`,await new Promise(((e,n)=>{window[t]=n=>{delete window[t],n&&n.default?e(n.default):e(null)}}))}initializeEvents(){}on(e,t){this.events[e]=t}emit(e,...t){this.events[e]&&this.events[e](...t)}setProperties(e){this.properties=e,this.store&&this.store.setProperties(this.properties)}async loadStore(){this.store=new ne(this),this.store.load(this.jsModules,this.properties);const e=this.getNodes().filter((e=>e.config.store));for(const t of e)await t.load(),this.store.load([Object.assign(t.componentDefinition.component,{name:t.config.id})],t.getProperties())}},be="1.1.0",ve=class{constructor({baseUrl:e}){this.VERSION=be,this.ky=_.Z,this.baseUrl=e,this.services={loader:new Y({baseUrl:this.baseUrl})},this.delegateMethods(this.services.loader,["loadScript","loadJSON","loadCss","getPackageJSON","loadComponent"])}parseRidgePath(e){let t=e;"/"===t[0]&&(t=t.substring(1));const[n,i,...o]=t.split("/"),[s,...r]=t.split("/");return"@"===n[0]?[n+"/"+i,o]:[s,r]}delegateMethods(e,t,n=this){for(const i of t)e[i]?n[i]=e[i].bind(e):console.error("delegateMethods error:",e+"."+i)}unDelegateMethods(e,t,n=this){for(const e of t)delete n[e]}static async init(){}async createComposite(e,t,n){if(null==e||null==t)return;const i=e.startsWith("/")||e.startsWith("http")?e:this.baseUrl+"/"+e;try{const e=await this.loadJSON((i+"/"+t+".json").replace(/\/\//g,"/"));return new fe({config:e,context:this,appBaseUrl:i,properties:n})}catch(e){return console.error("createComposite error",e),null}}},ye=({app:e,page:t,ridge:n,...i})=>{const o=(0,b.useRef)(null),s=()=>{const e={},t={};for(const n in i??{})"function"==typeof i[n]?e[n]=i[n]:t[n]=i[n];return{events:e,properties:t}};return(0,b.useEffect)((()=>{const i=n||(globalThis.ridge??new ve({baseUrl:"https://cdn.jsdelivr.net/npm/"}));o.current.ridgeComposite&&o.current.ridgeComposite.unmount();const{events:r,properties:a}=s();i.createComposite(e,t,a).then((e=>{if(e){for(const t in r??{})e.on(t,((...e)=>{r[t].apply(null,e)}));e.mount(o.current),o.current.ridgeComposite=e}}))}),[e,t]),(0,b.useEffect)((()=>{if(o.current.ridgeComposite){const{properties:e}=s();o.current.ridgeComposite.store.setProperties(e)}})),b.createElement("div",{ref:o,className:"composite-view",style:{width:"100%",height:"100%"}})};window.Ridge=ve;const we=ve;var xe=n(64551),Ce=n.n(xe),Ee=n(20927),ke=n.n(Ee),Se=n(82858),Pe=n.n(Se);const ze=async e=>{const t=await fetch(e);return await t.blob()},Fe=async e=>{const t=await ze(e);return await t.text()},Ne=(e,t)=>new Blob([e],{type:t}),Le=async e=>new Promise((t=>{const n=new FileReader;n.addEventListener("load",(()=>{t(n.result)}),!1),n.readAsDataURL(e)})),Oe=(e,t)=>{const n=document.createElement("a");e instanceof Blob?n.href=window.URL.createObjectURL(e):n.href=window.URL.createObjectURL(new Blob([e],{type:"text/plain"})),n.download=t||e.name||"下载",n.rel="noopener",setTimeout((function(){URL.revokeObjectURL(n.href)}),4e4),setTimeout((function(){!function(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){const n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}(n)}),0)};var je=n(57053);const Te=(e,t)=>e.filter((e=>-1===e.parent)).map((n=>Ie(n,null,e,t))).sort(De),De=(e,t)=>"directory"===e.type&&"directory"===t.type?e.label>t.label?1:-1:"directory"===e.type?-1:"directory"===t.type||e.label>t.label?1:-1,Ae=async(e,t)=>{for(const n of e)await t(n),n.children&&await Ae(n.children,t)},Me=(e,t)=>{const n=[];return e.forEach((e=>{t(e)&&n.push(e),e.children&&n.push(...Me(e.children,t))})),n},Re=(e,t)=>{const n=[];return e.forEach((e=>{const i=t(e);i&&(e.children?(i.children=Re(e.children,t),i.children.length&&n.push(i)):n.push(i))})),n},Ie=(e,t,n,i)=>{const o={id:e.id,key:e.id,label:e.name,type:e.type,path:-1===e.parent?"/"+e.name:t.path+"/"+e.name,parent:e.parent,parentNode:t,raw:e,value:e.id};if(e.mimeType&&(o.mimeType=e.mimeType),"directory"===o.type){const t=n.filter((t=>t.parent===e.id));o.children=t.map((e=>Ie(e,o,n,i))).sort(De)}return i&&i(o),o};var Ze=n(14206),Ve=n.n(Ze),Be=n(57487);const Ue=new Map;Ue.set(".js","text/javascript"),Ue.set(".json","text/json"),Ue.set(".doc","application/msword"),Ue.set(".pdf","application/pdf"),Ue.set(".woff","application/font-woff"),Ue.set(".zip","application/zip"),Ue.set(".mid","audio/midi"),Ue.set(".mp4a","audio/mp4"),Ue.set(".m4a","audio/mp4a-latm"),Ue.set(".ogg","audio/ogg"),Ue.set(".aac","audio/x-aac"),Ue.set(".m3u","audio/x-mpegurl"),Ue.set(".wma","audio/x-ms-wma"),Ue.set(".gif","image/gif"),Ue.set(".jpeg","image/jpeg"),Ue.set(".jpg","image/jpeg"),Ue.set(".png","image/png"),Ue.set(".svg","image/svg+xml"),Ue.set(".ico","image/x-icon"),Ue.set(".css","text/css"),Ue.set(".csv","text/csv"),Ue.set(".html","text/html"),Ue.set(".txt","text/plain"),Ue.set(".avi","video/x-msvideo"),Ue.set(".gz","application/x-gzip"),Ue.set(".tgz","application/x-tar"),Ue.set(".tar","application/x-tar");const _e=e=>Ue.get(e)||"application/"+e,qe=n(99591);class Je{constructor(e){this.appService=e,this.coll=e.collection,this.store=e.store,this.archiveColl=new(Ce())("ridge.backup.db")}async createHistory(e,t){const n=(0,je.formateDate)(),i="ridge.backup-store-"+n+".db",o={created:n,name:t,pageCount:await e.count({type:"page"}),dbname:i};await this.archiveColl.insert(o);const s=new(Ce())(i);await this.dumpColl(e,s)}async dumpColl(e,t){await t.clean();const n=await e.find({});for(const e of n)await t.insert(e)}async listAllHistory(){return await this.archiveColl.find({})}async deleteHistory(e){const t=await this.archiveColl.findOne(e);if(t){const n=new(Ce())(t.dbname);await n.clean(),await this.archiveColl.remove(e)}}async recover(e,t){const n=await this.archiveColl.findOne(e);if(n){const e=new(Ce())(n.dbname);return await t.clean(),await this.dumpColl(e,t),!0}return!1}async exportFileArchive(e){const t=await this.coll.findOne({id:e}),n=await this.store.getItem(e);n&&("page"===t.type?Oe(new Blob([JSON.stringify(n)]),t.name+".json"):Oe(await ze(n),t.name))}async importFileArchive(e,t){const{appService:n}=this;if(t.name.endsWith(".json")){const i=JSON.parse(await t.text());i.elements?await n.createPage(e,(0,je.basename)(t.name,".json"),i):await n.createFile(e,new File([JSON.stringify(i)],t.name,{type:"text/json"}))}else await n.createFile(e,t)}async exportAppArchive(){const e=new(Pe()),t=await this.coll.find({}),n=Te(t);await this.zipFolder(e,n);const i=await e.generateAsync({type:"blob"});Oe(i,"应用归档"+(0,je.formateDate)()+".zip")}async zipFolder(e,t){for(const n of t)if("directory"===n.type){const t=e.folder(n.label);await this.zipFolder(t,n.children)}else{const t=await this.store.getItem(n.key);"page"===n.type?e.file(n.label+".json",JSON.stringify(t)):e.file(n.label,await ze(t))}}async importAppArchive(e){const t=new(Pe());try{await t.loadAsync(e)}catch(e){return console.error("import file fail"),[]}const{appService:n}=this;await this.coll.clean(),await this.store.clear();const i=[];t.forEach((async(e,t)=>{i.push({filePath:e,zipObject:t})}));for(const{filePath:e,zipObject:t}of i)t.dir?await n.ensureDir(e):await this.importSingleFile(e,t);return i}async importSingleFile(e,t){const{appService:n}=this,i=await n.ensureDir((0,je.dirname)(e)),o=i?i.id:-1,s=(0,je.basename)(t.name),r=(0,je.extname)(t.name);if(e.endsWith(".json")){const e=JSON.parse(await t.async("text"));e.elements?await n.createComposite(o,(0,je.basename)(s,".json"),e):await n.createFile(o,s,new File([JSON.stringify(e)],s),"text/json")}else await n.createFile(o,s,new File([await t.async("blob")],s),_e(r))}async importFromNpmRegistry(e,t="1.0.0"){const n=await Ve().get(`https://registry.npmjs.org/${e}/-/${e}-${t}.tgz`,{responseType:"arraybuffer"}),i=qe.ungzip(n.data),o=new Be.TarReader,s=await o.readFile(new Blob([i.buffer],{type:"application/gzip"})),{appService:r}=this;for(const e of s)if(e.name.startsWith("package")){const t=e.name.substring(7),n=o.getFileBlob(e.name),i=await r.ensureDir((0,je.dirname)(t)),s=i?i.id:-1,a=(0,je.basename)(t),l=(0,je.extname)(t);if(t.endsWith(".json")){const n=JSON.parse(o.getTextFile(e.name));n.elements?(await r.deleteFileByPath(t.substring(0,t.length-5)),await r.createComposite(s,(0,je.basename)(a,".json"),n)):(await r.deleteFileByPath(t),await r.createFile(s,a,new File([JSON.stringify(n)],a),"text/json"))}else await r.deleteFileByPath(t),await r.createFile(s,a,new File([n],a),_e(l));console.log("import file",t)}await r.updateAppFileTree()}}const $e={version:be,style:Object.assign({width:1920,height:1080,background:"",classNames:[]}),properties:[],cssFiles:[],jsFiles:[],elements:[]},{nanoid:He}=n(57053),We=I()("ridge:app-service");class Ke{constructor(){this.collection=new(Ce())("ridge.app.db"),this.store=ke().createInstance({name:"ridge-store"}),this.backUpService=new Je(this),this.dataUrlByPath={},this.dataUrls={},this.fileTree=null}async init(){await this.getAppFileTree()}getFileTree(){return this.fileTree}mapFileTree(e){return Re(this.fileTree,e)}filterFiles(e){return Me(this.fileTree,e)}getFileByPath(e){const t=Me(this.fileTree,(t=>t.path===e));return t.length>0?t[0]:null}async getAppFileTree(){if(!this.fileTree){const e=await this.getFiles();this.fileTree=Te(e)}return this.fileTree}async updateAppFileTree(){We("Update File Tree");const e=await this.getFiles();this.fileTree=Te(e)}async createDirectory(e,t){if(We("createDirectory",e,t),await this.collection.findOne({parent:e,name:t}))throw new Error("File existed",t);const n={parent:e,id:He(10),name:t,type:"directory"};return await this.collection.insert(n)}async createComposite(e,t,n){if(We("createComposite",e,t),await this.collection.findOne({parentId:e,name:t}))throw new Error("File existed",t);const i=He(10),o=n??$e,s={id:i,name:t,type:"page",parent:e,mimeType:"text/json"};return await this.store.setItem(i,o),await this.collection.insert(s),s}async createFile(e,t,n,i){if(We("createFile",e,t),await this.collection.findOne({parent:e,name:t}))throw new Error("File existed",t);const o=He(10),s=await Le(n);return await this.store.setItem(o,s),await this.collection.insert({id:o,mimeType:n.type||i,size:n.size,name:t,parent:e})}async updateFileContent(e,t,n){this.filterFiles((t=>t.id===e))[0].textContent=t,await this.store.setItem(e,(async(e,t)=>{const n=new Blob([e],{type:t});return await Le(n)})(t,n))}async savePageContent(e,t){await this.store.setItem(e,t)}async rename(e,t){const n=await this.collection.findOne({id:e});return!!n&&(!await this.collection.findOne({parent:n.parent,name:t})&&(await this.collection.patch({id:e},{name:t}),!0))}async checkNewNameValid(e,t){return await this.collection.findOne({parent:e,name:t})}async move(e,t){const n=await this.collection.findOne({id:e});return n.parent!==t&&(!await this.collection.findOne({parent:t,name:n.name})&&(await this.collection.patch({id:e},{parent:t}),await this.updateAppFileTree(!0),!0))}async copy(e){const t=await this.collection.findOne({id:e});if(t){const n=He(10),i={id:n,name:t.name+"_"+n,type:t.type,parent:t.parent,mimeType:t.mimeType,copyFrom:e};await this.collection.insert(i);const o=await this.store.getItem(t.id);o&&await this.store.setItem(n,o),await this.updateAppFileTree(!0)}}async deleteFile(e){let t=null;if(t="string"==typeof e?await this.collection.findOne({id:e}):e,t){"directory"!==t.type&&await this.store.removeItem(t.id);const e=await this.collection.find({parent:t.id});if(e.length)for(const t of e)await this.deleteFile(t.id);return await this.collection.remove({id:t.id}),!0}return!1}async deleteFileByPath(e){const t=await this.getFileByPath(e);return!!t&&await this.deleteFile(t)}async getPackageJSONObject(){const e=this.getFileByPath("/package.json");if(null==e)return null;{const t=await this.store.getItem(e.key);try{return JSON.parse(await Fe(t))}catch(e){return{}}}}async getFiles(e){const t={};e&&(t.name=new RegExp(e));const n=await this.collection.find(t);return n.filter((e=>-1===e.parent&&"package.json"===e.name))[0]||n.push(await this.createFile(-1,"package.json",Ne(JSON.stringify({name:"ridge-app-hello",version:"1.0.0",description:"My First Ridge App #RidgeApp #HelloWorld",dependencies:{"ridge-basic":"1.0.0","ridge-container":"1.0.0"}},null,2),"text/json"))),n}async getFile(e){const t=await this.collection.findOne({id:e});if(t)return t.content=await this.store.getItem(e),t.mimeType.startsWith("text")&&(t.textContent=await Fe(t.content)),t}async ensureDir(e){const t=e.split("/");let n=-1,i=null;for(const e of t)e&&(i=await this.collection.findOne({parent:n,name:e}),null==i&&(i=await this.createDirectory(n,e)),n=i.id);return i}async getRecentPage(){const e=await this.collection.find({parent:-1,type:"page"},{sort:{name:1}});return 0===e.length?this.createPage(-1):{...e[0],...await this.store.getItem(e[0].id)}}async getFilePath(e){if(e.parent&&-1!==e.parent){const t=await this.getFile(e.parent);return await this.getFilePath(t)+"/"+e.name}return e.name}async getByMimeType(e){const t=await this.collection.find({mimeType:new RegExp(e)});for(const e of t)"file"===e.type&&(e.src=await this.store.getItem(e.id));return t}async isParent(e,t){let n=await this.getFile(t);for(;-1!==n.parent;){if(n.parent===e)return!0;n=await this.getFile(n.parent)}return!1}async updateDataUrl(){const e=await this.getByMimeType("image");for(const t of e)this.dataUrls[t.id]=t.dataUrl}getDataUrl(e){return e.startsWith("http")?e:this.dataUrlByPath[e]}async getFileContent(e){const t=await this.store.getItem(e.key);return e.mimeType&&e.mimeType.indexOf("text")>-1?await Fe(t):await ze(t)}async exportAppArchive(){await this.backUpService.exportAppArchive(this.collection,this.store)}async exportPage(e){const t=await this.collection.findOne({id:e}),n=await this.store.getItem(e);n&&("page"===t.type?Oe(new Blob([JSON.stringify(n)]),t.name+".json"):Oe(await ze(n),t.name))}async importFromNpmRegistry(e,t){return await this.backUpService.importFromNpmRegistry(e,t)}async importAppArchive(e){return await this.backUpService.importAppArchive(e,this.collection,this.store)}async backUpAppArchive(e){await this.backUpService.createHistory(this.collection,e)}async recoverBackUpAppArchive(e){await this.backUpService.recover(e,this.collection)}async getAllBackups(){return await this.backUpService.listAllHistory()}async removeBackup(e){return await this.backUpService.deleteHistory(e)}async exportArchive(){this.backUpService.exportColl(this.collection)}async archive(){}}var Ye=n(29507),Ge=n(63817),Xe=n.n(Ge);const Qe=".ridge-editor-element",et=I()("ridge:workspace");class tt{init({workspaceEl:e,viewPortEl:t}){this.workspaceEl=e,this.viewPortEl=t,this.zoom=1,this.selectorDropableTarget=[".ridge-container",".ridge-droppable"],this.initKeyBind(),this.initComponentDrop(),this.dragActive=!0,this.selected=[],this.viewPortEl.style.transformOrigin="center center"}enable(){this.initSelecto(),this.initMoveable(),this.setWorkSpaceMovable(),this.enabled=!0}setDragActive(e){this.dragActive=e}disable(){this.enabled&&(this.selecto.destroy(),this.selecto=null,this.moveable.destroy(),this.moveable=null,this.workspaceMovable&&(this.workspaceMovable.destroy(),this.workspaceMovable=null),this.enabled=!1,this.viewPortEl.style.transform="")}updateMovable(){this.moveable.updateTarget()}fitToCenter(e=40){this.viewPortEl.style.transform="";const t=this.workspaceEl.getBoundingClientRect(),n=this.viewPortEl.getBoundingClientRect();this.zoom=1;const i=function(e,t){if(e.width<t.width&&e.height<t.height)return e;const n={};return e.width/e.height>t.width/t.height?(n.fitTo="width",n.width=parseInt(t.width),n.height=Math.floor(e.height*(t.width/e.width))):(n.fitTo="height",n.width=Math.floor(e.width*(t.height/e.height)),n.height=parseInt(t.height)),n}({width:n.width,height:n.height},{width:t.width-2*e,height:t.height-2*e});return i.width!==n.width?(this.viewPortX=0,this.viewPortY=0,this.zoom):(this.viewPortX=(t.width-i.width)/2,this.viewPortY=(t.height-i.height)/2,this.viewPortEl.style.transform=`translate(${this.viewPortX}px, ${this.viewPortY}px) scale(${this.zoom})`,this.zoom)}setZoom(e){this.zoom=e,this.moveable&&(this.moveable.target=[],this.moveable.updateTarget()),this.viewPortEl.style.transform=`translate(${this.viewPortX}px, ${this.viewPortY}px) scale(${this.zoom})`}setWorkSpaceMovable(){this.workspaceMovable=k({target:this.workspaceEl,className:"workspace-movable"}),this.workspaceMovable.on("dragStart",(e=>{e.inputEvent.ctrlKey?(this.workspaceMovable.dragWorkSpace=!0,this.moveable.target=[]):this.workspaceMovable.dragWorkSpace=!1})),this.workspaceMovable.on("drag",(e=>{e.inputEvent.ctrlKey&&this.workspaceMovable.dragWorkSpace&&(this.moveable.target=null,this.viewPortX+=e.delta[0],this.viewPortY+=e.delta[1],this.viewPortEl.style.transform=`translate(${this.viewPortX}px, ${this.viewPortY}px) scale(${this.zoom})`)}))}isElementMovable(e){return null!=this.moveable.target&&1===this.moveable.target.length&&this.moveable.target[0]==e}initMoveable(){const e=this;this.moveable=k({target:[],snappable:!0}),this.moveable.on("dragStart",(e=>{if(!this.dragActive)return!1})),this.moveable.on("drag",(t=>{if(!this.dragActive)return!1;const n=t.target;if(!e.isTargetMovable(n))return;if(this.workspaceMovable.dragWorkSpace)return;const i=t.target.ridgeNode.config;e.onElementDragStart(t.target,t.inputEvent),t.target.style.transform=`translate(${i.style.x+t.dist[0]}px,${i.style.y+t.dist[1]}px)`})),this.moveable.on("dragEnd",(t=>{if(!this.dragActive)return!1;const n=t.target;t.isDrag&&e.isTargetMovable(n)?e.placeElementAt(n,t.clientX,t.clientY):e.selectElements([n])})),this.moveable.on("resize",(({target:t,width:n,height:i,drag:o,delta:s,transform:r})=>{if(!e.isTargetResizable(t))return;const a={};r.match(/[0-9.]+/g),a.x=o.translate[0],a.y=o.translate[1],s[0]&&(a.width=n),s[1]&&(a.height=i),t.ridgeNode.updateStyleConfig(a)})),this.moveable.on("resizeEnd",(({target:e,width:t,height:n,delta:i,transform:o})=>{this.selectElements([e])})),this.moveable.on("dragGroup",(({events:t})=>{t.forEach((({target:t,transform:n})=>{e.isTargetMovable(t)&&(t.ridgeNode.config.parent||(t.style.transform=n))}))})),this.moveable.on("dragGroupEnd",(e=>{e.events.forEach((({target:e})=>{if(!e.ridgeNode.config.parent){const t=e.getBoundingClientRect();this.putElementToRoot(e,t.left+t.width/2,t.top+t.height/2)}}))})),this.moveable.on("resizeGroup",(({events:t})=>{t.forEach((({target:t,width:n,height:i,delta:o,transform:s})=>{e.isTargetResizable(t)&&(t.style.transform=s,o[0]&&(t.style.width=`${n}px`),o[1]&&(t.style.height=`${i}px`))}))})),this.moveable.on("resizeGroupEnd",(e=>{e.events.forEach((({target:e})=>{if(!e.ridgeNode.config.parent){const t=e.getBoundingClientRect();mt.updateComponentConfig(e.ridgeNode,{style:{x:t.left+t.width/2,y:t.top+t.height/2}})}}))}))}initSelecto(){this.selecto=new Ye.ZP({rootContainer:null,dragContainer:this.workspaceEl,selectableTargets:[Qe],selectByClick:!0,selectFromInside:!0,continueSelect:!1,toggleContinueSelect:"ctrl",preventDefault:!0,keyContainer:window,hitRate:0}),this.selecto.on("dragStart",this.onSelectoDragStart.bind(this)),this.selecto.on("selectEnd",this.onSelectoDragEnd.bind(this))}onSelectoDragStart(e){const t=e.inputEvent,n=t.target;if(n.classList&&(n.classList.contains("moveable-area")||n.classList.contains("moveable-control")))return void e.stop();if(t.ctrlKey)return void e.stop();if(n.closest(".menu-bar"))return void e.stop();const i=n.closest(Qe);this.isElementMovable(i)?e.stop():i?(this.moveable.target&&1===this.moveable.target.length&&this.moveable.target[0].contains(i)&&this.disableClickThrough||(this.moveable.target=i),this.guidelines=[document.querySelector(".viewport-container"),...Array.from(document.querySelectorAll(Qe)).filter((e=>e!==this.moveable.target&&e.closest(Qe)!==this.moveable.target))],this.moveable.elementGuidelines=this.guidelines,this.moveable.elementSnapDirections={top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},this.moveable.snapDirections={top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},this.dragActive&&this.moveable.dragStart(t),e.inputEvent&&e.inputEvent.stopPropagation(),e.inputEvent&&e.inputEvent.preventDefault(),e.stop()):t.ctrlKey&&e.stop()}onSelectoDragEnd({isDragStart:e,selected:t,inputEvent:n,rect:i}){e&&n.preventDefault(),this.moveable.elementGuidelines=[document.querySelector(".viewport-container"),...Array.from(document.querySelectorAll(Qe)).filter((e=>-1===t.indexOf(e)))],this.guidelines=[document.querySelector(".viewport-container"),...Array.from(document.querySelectorAll(`${Qe}[snappable="true"]`)).filter((e=>-1===t.indexOf(e)))],this.selectElements(t.filter((e=>e.parentElement)))}initComponentDrop(){this.workspaceEl.addEventListener("dragover",this.onWorkspaceDragOver.bind(this)),this.workspaceEl.addEventListener("drop",this.onWorkspaceDrop.bind(this))}onWorkspaceDragOver(e){this.enabled&&(mt.draggingComponent&&(this.selected.length&&this.selectElements([]),e.dataTransfer.dropEffect="move",this.checkDropTargetStatus({width:mt.draggingComponent.width,height:mt.draggingComponent.height,clientX:e.clientX,clientY:e.clientY})),e.preventDefault())}onWorkspaceDrop(e){if(this.enabled&&(e.preventDefault(),mt.draggingComponent)){const t=mt.createElement(mt.draggingComponent);this.placeElementAt(t.el,e.pageX,e.pageY),mt.draggingComponent=null}}checkDropTargetStatus({target:e,clientX:t,clientY:n,width:i,height:o}){this.getDroppableTarget(e,{x:t,y:n,width:i,height:o},!0)}placeElementAt(e,t,n){et("placeElementAt:",e,{x:t,y:n}),this.putElementToRoot(e,t,n);const i=this.getDroppableTarget(e,{x:t,y:n},!1),o=i?i.ridgeNode:null;if(o){et("Into container",o);const t=e.getBoundingClientRect(),n=i.getBoundingClientRect();mt.editorComposite.removeChild(e.ridgeNode),o.appendChild(e.ridgeNode,{x:Math.floor((t.x-n.x)/this.zoom),y:Math.floor((t.y-n.y)/this.zoom)},t)}mt.onElementMoveEnd(e),this.moveable.updateTarget()}putElementToRoot(e,t,n){const i=this.viewPortEl.getBoundingClientRect(),o=e.getBoundingClientRect();null==t||null==n||t>o.x&&t<o.x+o.width&&n>o.y&&n<o.y+o.height?e.ridgeNode.updateStyleConfig({x:Math.floor((o.x-i.x)/this.zoom),y:Math.floor((o.y-i.y)/this.zoom)}):e.ridgeNode.updateStyleConfig({x:Math.floor((t-i.x-o.width/2)/this.zoom),y:Math.floor((n-i.y-o.height/2)/this.zoom)}),this.moveable.updateTarget()}onElementDragStart(e,t){if(e.ridgeNode&&e.ridgeNode.parent&&e.ridgeNode.parent!==mt.editorComposite){const t=this.getElementRectConfig(e);e.ridgeNode.parent.removeChild(e.ridgeNode),mt.editorComposite.appendChild(e.ridgeNode),mt.services.outlinePanel.updateOutline(),e.ridgeNode.updateStyleConfig(t)}this.checkDropTargetStatus({target:e,clientX:t.clientX,clientY:t.clientY})}getElementRectConfig(e){const t=e.getBoundingClientRect(),n=this.viewPortEl.getBoundingClientRect();return{position:"absolute",x:(t.x-n.x)/this.zoom,y:(t.y-n.y)/this.zoom,width:t.width/this.zoom,height:t.height/this.zoom}}selectElements(e,t){this.disableClickThrough=!1,document.querySelectorAll(`${Qe}.selected`).forEach((e=>{e.classList.remove("selected")})),e&&e.length>0?(this.selected=e.filter((e=>!e.classList.contains("ridge-is-hidden"))),this.selected.length>1&&(this.selected=e.filter((e=>e.parentElement.classList.contains("ridge-composite")))),1===this.selected.length&&mt.onElementSelected(this.selected[0]),this.moveable.target=this.selected):(mt.onPageSelected(),this.selected=[],this.moveable.target=null),this.setSelectedStatus(),this.moveable.updateTarget()}setSelectedStatus(){1===this.selected.length?(this.moveable.moveable=!0,this.moveable.resizable=!0):this.selected.length>1&&(this.moveable.resizable=!1),this.moveable.elementGuidelines=[document.querySelector(".viewport-container"),...Array.from(document.querySelectorAll(`.viewport-container > ${Qe}:not(.ridge-is-hidden)`)).filter((e=>-1===this.selected.indexOf(e)))]}isTargetMovable(e){return!(!this.dragActive||e.classList.contains("ridge-is-locked")||e.classList.contains("ridge-is-full"))}isTargetResizable(e){return!e.classList.contains("ridge-is-locked")&&!e.classList.contains("ridge-is-full")}unSelectElements(e){this.selected=this.selected.filter((t=>-1===e.indexOf(t))),this.moveable.target=this.selected,this.moveable.updateTarget()}getDroppableTarget(e,t,n){let i=[];for(const e of this.selectorDropableTarget)i=i.concat(Array.from(document.querySelectorAll(e)));const o=Array.from(i).filter((n=>{if(!n.ridgeNode)return!1;const{x:i,y:o,width:s,height:r}=n.getBoundingClientRect();return(!n.invoke||!1!==n.invoke("isDroppable",[e]))&&(e?!e.contains(n)&&t.x>i&&t.x<i+s&&t.y>o&&t.y<o+r&&n!==e&&n.closest("[ridge-id]")!==e:t.x>i&&t.x<i+s&&t.y>o&&t.y<o+r)}));let s=null;if(1===o.length)s=o[0];else if(o.length>1){const e=o.sort(((e,t)=>e.contains(t)?1:t.contains(e)?-1:e.style.zIndex>t.style.zIndex?1:-1));s=e[0]}if(n){try{s&&s.ridgeNode&&s.ridgeNode.invoke("onDragOver",e?[e.ridgeNode||{}]:[t])}catch(e){console.error("Container dragOver Error",s)}i.forEach((e=>{e!==s&&e.ridgeNode&&e.ridgeNode.invoke("onDragOut")}))}return s}downloadImg(e,t){const n=document.createElement("a"),i=new window.MouseEvent("click");n.download=e||this.props.photoName||"photo",n.href=t,n.dispatchEvent(i)}initKeyBind(){Xe().bind("del",(()=>{if(this.enabled&&this.dragActive&&this.selected){for(const e of this.selected)mt.onElementRemoved(e);this.selectElements([])}})),Xe().bind("right",(()=>{if(this.selected){for(const e of this.selected){const t=mt.getNode(e);t.updateStyleConfig({x:t.config.style.x+1})}this.moveable.updateTarget()}})),Xe().bind("left",(()=>{if(this.selected){for(const e of this.selected){const t=mt.getNode(e);t.updateStyleConfig({x:t.config.style.x-1})}this.moveable.updateTarget()}})),Xe().bind("up",(()=>{if(this.selected){for(const e of this.selected){const t=mt.getNode(e);t.updateStyleConfig({y:t.config.style.y-1})}this.moveable.updateTarget()}})),Xe().bind("down",(()=>{if(this.selected){for(const e of this.selected){const t=mt.getNode(e);t.updateStyleConfig({y:t.config.style.y+1})}this.moveable.updateTarget()}})),Xe().bind("ctrl+c",(()=>{this.selected?(this.copied=this.selected,this.copied.forEach((e=>{e.dataset.copy_x=e.ridgeNode.config.style.x,e.dataset.copy_y=e.ridgeNode.config.style.y}))):this.copied=[]})),Xe().bind("ctrl+s",(e=>{e.preventDefault(),mt.saveCurrentPage()})),Xe().bind("ctrl+v",(()=>{if(this.copied&&this.copied.length)for(const e of this.copied){const t=e.ridgeNode.clone(),n=document.createElement("div");t.mount(n),this.selected&&1===this.selected.length?this.selected[0].ridgeNode.appendChild(t):mt.editorComposite.appendChild(t)}}))}}const nt=(e,t)=>{const n=t.services.appService.getFileByPath(e);return n?t.services.appService.store.getItem(n.key):null},it=async(e,t)=>{const n=document.querySelectorAll("style[local-path]");for(const e of n)document.head.removeChild(e);const{appService:i}=t.services,o=[];for(const t of e||[]){const e=i.getFileByPath(t);if(e){e.textContent||(e.textContent=await i.getFileContent(e));const n=document.createElement("style");n.setAttribute("local-path",t),document.head.appendChild(n),n.textContent="\r\n"+e.textContent;const s=e.textContent.match(/\/\*.+\*\/[^{]+{/g);for(const e of s){const t=e.match(/\/\*.+\*\//)[0].replace(/[/*]/g,""),n=e.match(/\n[^{]+/g)[0].trim().substring(1);o.push({className:n,label:t})}}}return o},ot=async(e,t)=>{const n=[],i=document.querySelectorAll("script[local-path]");for(const e of i)document.head.removeChild(e);for(const t of e||[]){const e=await st(t,(void 0).context);e&&n.push(e)}return n},st=async(e,t)=>{const{appService:n}=t.services,i=n.getFileByPath(e);if(i){i.textContent||(i.textContent=await n.getFileContent(i));const t=document.createElement("script");t.setAttribute("local-path",e);const o="ridge-store-"+(0,je.nanoid)(10);t.textContent=i.textContent.replace("export default",'window["'+o+'"]=');try{return document.head.append(t),window[o]}catch(e){return console.error("Store Script Error",e),null}}};class rt extends ge{getProperties(){return Object.assign({},this.config.props,this.properties,{children:this.children},{__isEdit:!0})}mounted(){null!=this.config.props.children&&this.el.classList.add("ridge-container"),this.el.classList.add("ridge-editor-element"),this.setLocked(this.config.locked)}appendChild(e,{x:t,y:n}={},i){let o=-1;this.hasMethod("checkNodeOrder")&&i&&(o=this.invoke("checkNodeOrder",[i])),o>-1?this.children.splice(o,0,e):this.children.push(e),e.parent=this,this.invoke("appendChild",[e,{x:t,y:n},o])}removeChild(e){this.children=this.children.filter((t=>t!==e)),e.parent=null;const{workspaceControl:t}=mt,n=t.getElementRectConfig(e.el);this.invoke("removeChild",[e]),e.setStyleConfig(n)}initPropsOnCreate(){if(this.componentDefinition){for(const e of this.componentDefinition.props||[])e&&(null!=e.value&&(this.config.props[e.name]=e.value),"children"===e.name&&(this.config.props.children=[],this.children=[]));"store"===this.componentDefinition.type&&(this.config.store=!0)}}getBlobUrl(e){return nt(e,mt)}setVisible(e){this.config.visible=e,this.updateStyle()}setLocked(e){e?this.el.classList.add("ridge-is-locked"):this.el.classList.remove("ridge-is-locked"),this.config.locked=e}updateStyleConfig(e){console.log("updateStyleConfig",e);let t=null;this.parent&&(t=this.parent.invoke("updateChildStyleConfig",[e])),t?Object.assign(this.config.style,t):Object.assign(this.config.style,e),this.style=this.config.style,this.updateStyle()}setStyleConfig(e){this.config.style=e,this.style=this.config.style,this.updateStyle()}updateChildConfig(e){this.config.props.children=e.map((e=>e.getId())),this.properties.children=e,this.updateProps()}updateConfig(e,t){console.log("updateConfig",e),Object.assign(this.config,e),Object.assign(this.properties,e.props),this.updateSystemProperties(),this.style=e.style,!0!==t&&(this.el&&(!0===this.config.locked?this.el.classList.add("ridge-is-locked"):this.el.classList.remove("ridge-is-locked")),this.updateStyle(),this.updateProps())}childRemoved(e){this.invoke("removeChild",[e])}updateChildList(e){this.children=e.map((e=>this.composite.getNode(e))).filter((e=>e)),this.invoke("updateChildList",[this.children])}selected(){this.invoke("selected"),this.parent&&this.parent.invoke&&this.parent.invoke("childSelected",[this])}clone(){const e=(0,M.cloneDeep)(this.config);e.id=(0,je.nanoid)(5);const t=new rt({composite:this.composite,componentDefinition:this.componentDefinition,config:e});if(this.children){t.children=[];for(const e of this.children){const n=e.clone();n.parent=t,t.children.push(n),this.composite.nodes[n.getId()]=n}}return this.composite.nodes[t.getId()]=t,t}exportJSON(){return this.children&&(this.config.props.children=this.children.map((e=>e.getId()))),JSON.parse(JSON.stringify(this.config))}}const at=class extends fe{createElement(e){return new rt({composite:this,config:e})}getClassNames(){return this.classNames||[]}updatePageConfig(e){Object.assign(this.config,e),this.updateStyle(),this.refresh()}async refresh(){await this.importStyleFiles(),await this.importJSFiles(),this.loadStore()}async loadStore(){this.storeModules=[];for(const e of this.jsModules)e&&e.name&&this.parseJsStoreModule(e);const e=this.getNodes((e=>e.componentDefinition&&"store"===e.componentDefinition.type));for(const t of e)await t.load(),t.renderer&&t.renderer.update({title:t.config.title}),this.parseJsStoreModule(Object.assign(t.componentDefinition.component,{name:t.config.id,label:t.config.title}))}updateStyle(){if(super.updateStyle(),this.config.style){const{width:e,height:t}=this.config.style;this.el.style.width=e+"px",this.el.style.height=t+"px",this.el.classList.add("is-edit"),this.el.classList.add("viewport-container")}}async importStyleFiles(){this.classNames=await it(this.config.cssFiles,this.context)}async importJSFiles(){return ot(this.config.jsFiles,this.context)}parseJsStoreModule(e){try{const t={module:e,label:e.label??"未命名",name:e.name,actions:[],states:[],computed:[],scoped:[]};if(e.state){let n={};"function"==typeof e.state?n=e.state({}):"object"==typeof e.state&&(n=e.state);for(const e of Object.keys(n))t.states.push({name:e,value:n[e]})}if(e.scoped)for(const n of Object.keys(e.scoped))t.scoped.push({name:n});if(e.computed)for(const n of Object.keys(e.computed))t.computed.push({name:n});e.actions&&"object"==typeof e.actions&&Object.keys(e.actions||{}).forEach((e=>{t.actions.push({name:e})})),this.storeModules=this.storeModules.filter((e=>e.name!==t.name)),this.storeModules.push(t)}catch(t){console.error("jsStoreModule Parse Error",e)}}getStoreModules(){return this.storeModules}createNewElement(e){const t={title:e.title,path:e.componentPath,id:(0,je.nanoid)(5),style:{position:"absolute",visible:!0,width:e.width??100,height:e.height??100},styleEx:{},props:{},propEx:{},events:{},visible:!0,locked:!1,full:!1},n=new rt({config:t,componentDefinition:e,composite:this});return n.parent=this,this.nodes[n.getId()]=n,n.initPropsOnCreate(),n}unmount(){super.unmount(),this.el.style.width=0,this.el.style.height=0,this.el.classList.remove("is-edit")}appendChild(e){this.children.push(e),e.parent=this,this.el.appendChild(e.el),e.updateStyle()}removeChild(e){this.children=this.children.filter((t=>t!==e)),e.parent=null,this.el.removeChild(e.el)}deleteNode(e){if(e){const t=e.getParent();t&&t.removeChild(e);for(const t of e.children??[])this.deleteNode(t);e.unmount(),e.componentDefinition&&"store"===e.componentDefinition.type&&(this.storeModules=this.storeModules.filter((t=>t.name!==e.config.id))),delete this.nodes[e.getId()]}}updateChildList(e){for(const e of this.children)this.el.removeChild(e.el);this.children=[];for(let t=0;t<e.length;t++){const n=this.getNode(e[t]);n&&this.appendChild(n)}}childAppended(e){e.updateStyle()}onEditorElementCreated(e){e.componentDefinition&&"store"===e.componentDefinition.type&&this.parseJsStoreModule(Object.assign(e.componentDefinition.component,{name:e.config.id,label:e.config.title}))}exportPageJSON(){this.config.elements=[];for(const e of this.getNodes())this.config.elements.push(e.exportJSON());return this.config.children=this.children.map((e=>e.getId())),(0,M.cloneDeep)(this.config)}},lt=class extends fe{createElement(e,t){const n=new ge({composite:this,compositeView:this,config:e,i:t});return n.getBlobUrl=e=>nt(e,this.context),n}async importStyleFiles(){this.classNames=it(this.config.cssFiles,this.context)}async importJSFiles(){return ot(this.config.jsFiles,this.context)}updateViewPort(e,t){this.el.style.width=e+"px",this.el.style.height=t+"px"}async loadStore(){this.store=new ne(this),this.store.load(this.jsModules,this.properties);const e=this.getNodes().filter((e=>e.config.store));for(const t of e)await t.load(),this.store.load([Object.assign(t.componentDefinition.component,{name:t.config.id})],t.getProperties())}},ct=I()("ridge:editor"),dt=new URLSearchParams(location.href).get("registry")||localStorage.getItem("registry")||"https://cdn.jsdelivr.net/npm",pt=location.host.startsWith("localhost")||location.host.startsWith("127.0.0.1")?"/npm":dt,ht=new class extends we{constructor({baseUrl:e}){super({baseUrl:e}),this.baseUrl=e,this.services.appService=new Ke,window.ridge=this,window.editor=this,this.checkInterval=setInterval(this.checkModification.bind(this),2e3)}async editorDidMount(e,t,n){this.Editor=e;const{appService:i}=this.services;await i.init();const o=new URLSearchParams(window.location.search);if(o.get("package"))if(0===i.getFileTree().length)await i.importFromNpmRegistry(o.get("package"),o.get("version"));else try{await e.confirm("您工作区已包含内容，页面导入文件会相同时覆盖现有文件，是否继续？"),await i.importFromNpmRegistry(o.get("package"),o.get("version"))}catch(e){}this.viewPortContainerEl=n,this.workspaceEl=t,this.workspaceControl=new tt,this.workspaceControl.init({workspaceEl:t,viewPortEl:n,ridgeEditorService:this}),this.Editor.setEditorLoaded()}getNode(e){if(e instanceof ge)return e;if("string"==typeof e){if(this.editorComposite)return this.editorComposite.getNode(e);if(this.runtimeView)return this.runtimeView.getNode(e)}else if(e instanceof Node)return e.ridgeNode;return null}async loadPackages(){const{appService:e}=this.services,t=await e.getPackageJSONObject();if(null==t)return[];const n=Object.keys(t.dependencies),i=[];for(const e of n)i.push(await this.getPackageJSON(e));return await Promise.allSettled(i),i.filter((e=>null!=e)).map((e=>(e.componentLoaded=!1,e.icon&&(e.icon=this.baseUrl+"/"+e.name+"/"+e.icon),e)))}async openFile(e){const{appService:t}=this.services,n=await t.getFile(e);n&&("page"===n.type?(this.currentOpenFile=n,await this.loadEdit(n)):n.mimeType.startsWith("text/")?this.Editor.openCodeEditor(n):n.mimeType.startsWith("image/")&&this.Editor.openImage(n.content))}async loadEdit(e){const{configPanel:t,outlinePanel:n,menuBar:i}=this.services;e&&(this.pageContent=e.content,this.pageContent.name=e.name),this.viewPortContainerEl.classList.remove("preview-full"),this.editorComposite&&this.editorComposite.unmount(),this.editorComposite=new at({config:(0,M.cloneDeep)(this.pageContent),context:this}),await this.editorComposite.load(),await this.editorComposite.mount(this.viewPortContainerEl),this.workspaceControl.enabled||this.workspaceControl.enable();const o=this.workspaceControl.fitToCenter();i.setZoom(o),this.Editor.togglePageEdit(),t.updatePageConfigFields(),this.workspaceControl.selectElements([]),n.updateOutline(!0)}async loadPreview(){this.previewComposite=new lt({config:this.pageContent,context:this}),await this.previewComposite.mount(this.viewPortContainerEl),this.Editor.togglePagePreview(),this.previewComposite.updateViewPort(this.pageContent.style.width,this.pageContent.style.height),this.pageContent.style.width<this.workspaceEl.offsetWidth&&this.pageContent.style.height<this.workspaceEl.offsetHeight&&this.workspaceControl.fitToCenter()}async toggleMode(){this.editorComposite?(await this.saveCurrentPage(),this.editorComposite.unmount(),this.editorComposite=null,this.workspaceControl.disable(),this.Editor.togglePageClose(),this.loadPreview(),this.workspaceEl.style.overflow="hidden auto"):this.previewComposite&&(this.previewComposite.unmount(),await this.loadEdit(),this.workspaceEl.style.overflow="")}onElementSelected(e){const{configPanel:t,outlinePanel:n}=this.services,i=this.getNode(e);i&&(i.selected(),t.componentSelected(i),n.setCurrentNode(i)),this.el=i}onElementRemoved(e){const t=this.getNode(e);t&&this.editorComposite&&this.editorComposite.deleteNode(t);const{outlinePanel:n}=this.services;n.updateOutline()}onElementMoveEnd(e){const{configPanel:t,outlinePanel:n}=this.services,i=this.getNode(e);i&&(t.componentSelected(i),n.updateOutline())}onFileRenamed(e,t){if(this.currentOpenFile&&this.currentOpenFile.id===e){this.editorComposite.config.name=t;const{configPanel:e}=this.services;e.updatePageConfigFields()}}createElement(e){const t=document.createElement("div"),n=this.editorComposite.createNewElement(e);return n.mount(t),this.editorComposite.appendChild(n),this.editorComposite.onEditorElementCreated(n),n}onPageSelected(){const{configPanel:e,outlinePanel:t}=this.services;this.el=null,e.updatePageConfigFields(),t.setCurrentNode()}updateComponentConfig(e,t){const n=(0,M.cloneDeep)(t),i=n.title!==e.config.title;if(e.updateConfig(n),i){const{outlinePanel:e}=this.services;e.updateOutline(),this.editorComposite.loadStore()}this.workspaceControl.updateMovable()}async onCodeEditComplete(e,t){await this.services.appService.updateFileContent(e,t),this.editorComposite&&await this.editorComposite.refresh()}checkModification(){if(this.editorComposite&&this.pageContent){const e=this.editorComposite.exportPageJSON();this.isModified=!(0,M.isEqual)(e,this.pageContent),this.services.menuBar&&this.services.menuBar.setPageChanged(this.isModified)}this.isModified=!0}async saveCurrentPage(){if(this.editorComposite){const{appService:e}=this.services,t=this.editorComposite.exportPageJSON();ct("Save Page ",t);try{await e.savePageContent(this.currentOpenFile.id,t),this.pageContent=t,this.services.menuBar.setPageChanged(!1)}catch(e){console.error("save page error",e)}}}closeCurrentPage(){this.editorComposite&&this.editorComposite.unmount(),this.currentOpenFile=null,this.editorComposite=null,this.workspaceControl.disable(),this.Editor.togglePageClose()}async createComposite(e,t,n){if(!e||!t){if(null==t)return;const{appService:e}=this.services,i=e.getFileByPath(t);return i.content=await e.store.getItem(i.id),new lt({config:i.content,context:this,properties:n})}super.createComposite(e,t,n)}getLocaleText(e){return e}}({baseUrl:pt}),mt=ht,gt=(0,y.Q2)((({value:e,onChange:t})=>{const[n,i]=(0,b.useState)([]),[o,s]=(0,b.useState)(),r=(e,t,n)=>{const i={key:n+e,label:mt.getLocaleText(e)};if((0,M.isPlainObject)(t)){i.children=[];for(const o in t)i.children.push(r(o,t[o],n+e+"."))}return i};return b.createElement(y.J2,{content:()=>b.createElement("div",{style:{width:"320px",padding:"0",height:"360px",overflow:"overlay"}},b.createElement(y.mp,{style:{height:320},value:e,filterTreeNode:!0,expandAll:!0,treeData:n,onSelect:n=>{e===n&&t(null)},onChange:e=>{t(e)}}),b.createElement(y.T,null,b.createElement(y.zx,{theme:"solid",onClick:()=>{s(!1)}},"确定"),b.createElement(y.zx,{theme:"solid",type:"secondary",onClick:()=>{t(null),s(!1)}},"取消连接"))),trigger:"click",showArrow:!0,visible:o,onVisibleChange:e=>{s(e),(()=>{const e=mt.editorComposite.getStoreModules(),t=[];for(const n of e){const e={key:n.name,label:n.label??n.name,children:[]};for(const t of n.states)e.children.push(r(t.name,t.value,n.name+".state."));for(const t of n.computed)e.children.push({key:n.name+".computed."+t.name,label:t.label??t.name});t.push(e)}i(t)})()}},b.createElement("div",{style:{height:26,display:"flex",alignItems:"center"}},b.createElement(y.zx,{className:"btn-code",placeholder:"连接数据",type:e?"primary":"tertiary",size:"small",theme:"borderless",onClick:()=>{s(!o)},icon:b.createElement(A.Z,{style:{margin:"0 2px",flexShrink:0}})})))}));var ut=n(86919),ft=n(35225),bt=n(52580),vt=n(72216),yt=n(98741);const{Text:wt}=y.Typography,{Option:xt}=y.Select,Ct=(0,y.Q2)((({value:e,options:t,onChange:n})=>{const[i,o]=(0,b.useState)(""),[s,r]=(0,b.useState)([]),a=e||[],l=()=>{const e=[...a,{store:"",method:"",payload:""}];r([...s,e.length-1]),n(e)},c=e=>{r([...s,e])},d=e=>{n(a.filter(((t,n)=>n!==e)))},p=e=>{r(s.filter((t=>t!==e.index))),n(a.map(((t,n)=>n===e.index?{store:e.store,method:e.method,payload:e.payload}:t)))},h=[{label:t.label,key:"action-root",root:!0,disabled:!0,children:[...a.map(((e,t)=>{const n={};return n.key="node-"+t,n.index=t,n.store=e.store,n.method=e.method,n.payload=e.payload||"",n.label=(e=>{if(null==mt.editorComposite)return e.method;const{storeName:t,method:n}=e,i=mt.editorComposite.getStoreModules();return i[t]?.actions.filter((e=>e.name===n))[0]?.label??n})(e),n}))]}];return b.createElement("div",{className:"event-edit"},b.createElement(y.mp,{className:"event-tree",expandAll:!0,disabled:!0,renderLabel:(e,t)=>b.createElement("div",{className:"tree-label"},t.root&&b.createElement(b.Fragment,null,b.createElement(wt,{className:"label-content"},b.createElement(y.Vp,{color:"green"},e," ")),b.createElement(y.T,{className:"action"},b.createElement(y.zx,{size:"small",theme:"borderless",type:"tertiary",onClick:l,icon:b.createElement(ut.Z,null)},"处理动作"))),!t.root&&s.indexOf(t.index)>-1&&(e=>{const t=mt.editorComposite.getStoreModules();return b.createElement(b.Fragment,null,b.createElement("div",{className:"label-content"},b.createElement(y.Select,{noLabel:!0,defaultValue:e.store+"."+e.method,placeholder:"请选择处理动作",size:"small",onChange:t=>{const[n,i]=t.split(".");e.store=n,e.method=i}},t.map((({label:e,name:t,actions:n})=>b.createElement(y.Select.OptGroup,{label:e??t,key:t},n.map((e=>b.createElement(y.Select.Option,{key:e.name,value:t+"."+e.name},e.label||e.name))))))),b.createElement(y.J2,{trigger:"click",content:b.createElement("div",{style:{padding:10}},b.createElement(wt,null,"请输入方法参数"),b.createElement(y.Kx,{value:i,onChange:e=>{o(e)}}),b.createElement(y.zx,{"aria-label":"确定",onClick:()=>{e.payload=i,p(e)}},"确定"))},b.createElement(y.zx,{theme:"borderless",type:"primary",onClick:()=>{o(e.payload)},size:"small",icon:b.createElement(ft.Z,null)}))),b.createElement(y.T,{className:"action"},b.createElement(y.zx,{size:"small",onClick:()=>{p(e)},icon:b.createElement(bt.Z,null)})))})(t),!t.root&&-1===s.indexOf(t.index)&&(e=>b.createElement(b.Fragment,null,b.createElement(wt,{className:"label-content"},e.label||"未配置动作",e.payload?`(${e.payload})`:""),b.createElement(y.T,{className:"action"},b.createElement(y.zx,{size:"small",icon:b.createElement(vt.Z,null),theme:"borderless",type:"tertiary",onClick:()=>{c(e.index)}}),b.createElement(y.zx,{size:"small",theme:"borderless",type:"tertiary",icon:b.createElement(yt.Z,null),onClick:()=>{d(e.index)}}))))(t)),treeData:h}))})),Et=Ct;n(5839);var kt=n(55097),St=n(35633),Pt=n(92895);const zt=(0,y.Q2)((({value:e,options:t,onChange:n})=>{const[i,o]=(0,b.useState)(!1),[s,r]=(0,b.useState)(""),a=b.createRef();return b.createElement("div",null,b.createElement(y.u_,{closeOnEsc:!1,lazyRender:!1,onCancel:()=>{o(!1),r("")},keepDOM:!0,title:"编辑JSON数据",visible:i,onOk:()=>{try{const e=a.current.editorComposite.state.doc.toString();if(""!==e){const t=JSON.parse(e);n(t)}else n("");o(!1),r("")}catch(e){r(e.message)}}},b.createElement("div",null,"默认值/代码"),b.createElement("div",{style:{border:"1px solid var(--semi-color-border)",overflow:"auto",height:"300px",width:"100%"},className:"code-editor-container",ref:a}),b.createElement("div",{style:{color:"red"}},s)),b.createElement(y.zx,{size:"small",type:"tertiary",onClick:()=>{o(!0),a.current.editorComposite&&a.current.editorComposite.destroy(),a.current.editorComposite=new kt.tk({doc:null!=e?JSON.stringify(e,null,2):"",extensions:[St.Xy,(0,Pt.AV)(),(0,kt.jH)({position:"absolute"})],parent:a.current}),a.current.editorComposite.jsonParseLinter=Pt.ap}},"编辑"))})),Ft=(0,y.Q2)((({value:e,onChange:t,options:n})=>{const{appService:i}=mt.services,o=i.mapFileTree((e=>"directory"===e.type||e.type===n.type||e.mimeType&&e.mimeType.indexOf(n.type)>-1?{label:e.label,value:e.path,key:e.path}:null));return b.createElement(y.mP,{leafOnly:!0,size:"small",onChange:e=>{t(e)},value:e,style:{width:180},dropdownStyle:{maxHeight:320,overflow:"auto"},renderLabel:(e,t)=>b.createElement("div",null,e),treeData:o,placeholder:"请选择"})}));var Nt=n(10888);const Lt=(0,y.Q2)((({position:e="border",value:t,onChange:n})=>{const i=(t||"0 0 0 0").split(" ").map((e=>parseInt(e)||0));return b.createElement(b.Fragment,null,b.createElement(y.II,{size:"small",value:t,onChange:n,suffix:b.createElement(y.J2,{trigger:"click",stopPropagation:!0,content:b.createElement("div",{className:"input-padding-pop"},b.createElement("div",{className:"input-padding position-"+e},i.map(((e,t)=>b.createElement(y.Rn,{className:"input-padding-number order-"+t,key:t,size:"small",value:e,onChange:e=>{i[t]=e,n(i.map((e=>e+"px")).join(" "))}})))))},b.createElement(Nt.Z,{style:{cursor:"pointer"}}))}))})),Ot=(0,y.Q2)((({value:e,onChange:t})=>{const n="string"!=typeof e?"#fff":e,i=n.match(/[0-9]+deg|\s[^%]+%/g);let o,s,r,a=[];null==i||i.length<3?(o=n,a.push({color:o})):(r=parseInt(i[0])||0,s=i.slice(1),a.push(...s.map((e=>{const t=e.trim().split(/\s+/);return{color:t[0],percent:parseInt(t[1])}}))));const l=e=>{e?a=a.filter(((t,n)=>n!==e)):a.push({color:"#fff",percent:100}),c()},c=()=>{1===a.length?t(a[0].color):t(`linear-gradient(${r||0}deg, ${a.map(((e,t)=>{let n=e.percent;return 0===t&&(n=0),t===a.length-1&&(n=100),e.color+" "+n+"%"})).join(", ")})`)};return b.createElement("div",{className:"background-edit"},b.createElement("div",{className:"color-list"},b.createElement(y.aV,{dataSource:a,size:"small",renderItem:(e,t)=>{let n=e.percent||0,i=!1;return 0===t&&(n=0,i=!0),t===a.length-1&&(n=100,i=!0),b.createElement(y.T,{style:{width:"100%"}},b.createElement(j,{value:e.color,onChange:e=>((e,t)=>{a=a.map(((n,i)=>({color:i===e?t:n.color,percent:n.percent}))),c()})(t,e)}),t>0&&b.createElement("div",{style:{flex:1}},b.createElement(y.iR,{value:n,disabled:i,onChange:e=>((e,t)=>{a=a.map(((n,i)=>({color:n.color,percent:i===e?t:n.percent}))),c()})(t,e)})),t>0&&b.createElement(y.zx,{icon:b.createElement("i",{className:"bi bi-x-lg"}),size:"small",type:"danger",onClick:()=>l(t),style:{marginRight:4}}))}}),a.length>1&&b.createElement(y.T,null,b.createElement(y.Rn,{insetLabel:"渐变角度",size:"small",value:r,onChange:e=>(e=>{r=e,c()})(e)}))),b.createElement("div",{style:{fontSize:14}},b.createElement(y.zx,{size:"small",theme:"borderless",icon:b.createElement("i",{className:"bi bi-plus-lg"}),onClick:()=>l()})))})),jt=(0,y.Q2)((({value:e,options:t,onChange:n})=>b.createElement(y.FX,{type:"button",buttonSize:"small",value:e,onChange:e=>{n(e.target.value)}},t&&t.map((e=>e.icon?b.createElement(y.Y8,{key:e.value,value:e.value},b.createElement("i",{className:e.icon,style:{fontSize:18}})):e.label?b.createElement(y.Y8,{key:e.value,value:e.value},b.createElement("div",{style:{fontSize:"14px",...e.style}},e.label)):b.createElement(y.Y8,{key:e.value,value:e.value})))))),Tt=jt;var Dt=n(76737),At=n(91897);const Mt=({value:e,options:t,onChange:n})=>b.createElement(y.J2,{showArrow:!0,trigger:"click",content:b.createElement(b.Fragment,null,b.createElement(y.zx,{size:"small",onClick:()=>{n(null)}},"清除颜色"),b.createElement(O.xS,{color:e,width:220,style:{boxShadow:"none"},triangle:"hide",onChange:e=>{n(e.hex+parseInt(255*e.rgb.a).toString(16))},onChangeComplete:e=>{n(e.hex+parseInt(255*e.rgb.a).toString(16))}}))},b.createElement(y.zx,{size:"small",style:{backgroundColor:e,height:"20px",width:"20px",margin:"0 3px",padding:0,border:"1px solid #ccc"}})),Rt=[{name:"宋体",value:"SimSun"},{name:"黑体",value:"SimHei"},{name:"微软雅黑",value:"Microsoft Yahei"},{name:"微软正黑体",value:"Microsoft JhengHei"},{name:"楷体",value:"KaiTi"},{name:"新宋体",value:"NSimSun"},{name:"仿宋",value:"FangSong"},{name:"幼圆",value:"YouYuan"},{name:"隶书",value:"LiSu"},{name:"苹方",value:"PingFang SC"}],It=(0,y.Q2)((({value:e,onChange:t})=>{const[n,i]=(0,b.useState)(!1),o=e||{},s=parseInt(o.fontSize||"20");return b.createElement(b.Fragment,null,b.createElement(y.T,null,b.createElement(y.Rn,{size:"small",style:{width:"46px"},value:s,onChange:e=>{t(Object.assign(o,{fontSize:e+"px"}))}}),b.createElement(Mt,{value:o.color,onChange:e=>{t(Object.assign(o,{color:e}))}}),b.createElement(y.zx,{icon:b.createElement(Dt.Z,null),size:"small",type:"bold"===o.fontWeight?"primary":"tertiary",theme:"bold"===o.fontWeight?"solid":"borderless",onClick:()=>{t(Object.assign(o,{fontWeight:"bold"===o.fontWeight?"normal":"bold"}))}}),b.createElement(y.zx,{type:"tertiary",theme:"borderless",icon:b.createElement(At.Z,{rotate:n?180:0}),onClick:()=>{i(!n)}})),b.createElement(y.zF,{isOpen:n},b.createElement(y.T,null,b.createElement(y.Select,{size:"small",defaultValue:o.fontFamily,style:{width:120},onChange:e=>{t(Object.assign(o,{fontFamily:e}))}},Rt.map((e=>b.createElement(y.Select.Option,{key:e.name,value:e.value},e.name)))))))})),Zt=It;var Vt=n(53523),Bt=n(91197);const Ut=(0,y.Q2)((({value:e,onChange:t,options:n})=>{const i=e||[],[o,s]=(0,b.useState)(1),r=(e,n,s)=>{t(i.map(((t,i)=>i===6*(o-1)+s?e?Object.assign(t,{[e]:n}):n:t)))};return b.createElement(b.Fragment,null,b.createElement(y.aV,{dataSource:(e=>{const t=6*(e-1),n=6*e;return i.slice(t,n)})(o),split:!1,size:"small",className:"component-list-demo-booklist",style:{border:"1px solid var(--semi-color-border)",flexBasis:"100%",flexShrink:0},renderItem:(e,n)=>{let s=null;if("string"==typeof e)s=b.createElement(y.II,{onChange:e=>{r("",e,n)},value:e,size:"small"});else{const t=Object.keys(e);s=b.createElement(b.Fragment,null,t.map((t=>b.createElement(y.II,{key:t,onChange:e=>{r(t,e,n)},value:e[t],size:"small"}))))}return b.createElement("div",{style:{margin:4,gap:4,display:"flex"},className:"list-item"},s,b.createElement(y.zx,{size:"small",type:"danger",theme:"borderless",icon:b.createElement(Vt.Z,null),onClick:()=>(e=>{t(i.filter(((t,n)=>n!==6*(o-1)+e)))})(n),style:{marginRight:4}}))}}),b.createElement("div",{style:{margin:4,fontSize:14,display:"flex",justifyContent:"space-between"}},b.createElement(y.zx,{size:"small",theme:"borderless",icon:b.createElement(Bt.Z,null),onClick:()=>{t([...i,JSON.parse(JSON.stringify(n.item))])},style:{marginRight:4,color:"var(--semi-color-info)"}},"新增项"),b.createElement("div",null,i.length>6&&b.createElement(y.tl,{size:"small",style:{height:24,width:"100%",flexBasis:"100%",justifyContent:"center"},pageSize:6,total:i.length,currentPage:o,onChange:e=>s(e)}))))})),_t=Ut;var qt=n(18042),Jt={};Jt.styleTagTransform=g(),Jt.setAttributes=d(),Jt.insert=l().bind(null,"head"),Jt.domAPI=r(),Jt.insertStyleElement=h(),o()(qt.Z,Jt),qt.Z&&qt.Z.locals&&qt.Z.locals;const $t=(0,y.Q2)((({value:e,onChange:t})=>{const[n,i]=(0,b.useState)([]);return(0,b.useEffect)((()=>{mt.editorComposite&&i(mt.editorComposite.getClassNames().map((e=>({label:e.label,value:e.className}))))}),[e]),b.createElement(y.Select,{size:"small",multiple:!0,value:e,onChange:t},n.map((e=>b.createElement(y.Select.Option,{value:e.value,key:e.value},e.label))))})),Ht=(0,y.Q2)((({value:e,onChange:t})=>{const[n,i]=(0,b.useState)([]);return(0,b.useEffect)((()=>{i(mt.appService.filterFiles((e=>e.mimeType&&e.mimeType.indexOf("audio")>-1)).map((e=>(console.log("audio file=>",e),{value:e.path,label:e.label}))))}),[e]),b.createElement(y.Select,{size:"small",value:e,showClear:!0,onChange:t},n&&n.map((e=>b.createElement(y.Select.Option,{value:e.value,key:e.value},e.label))))})),Wt=[{name:"默认",value:"default"},{name:"宋体",value:"SimSun"},{name:"黑体",value:"SimHei"},{name:"微软雅黑",value:"Microsoft Yahei"},{name:"微软正黑体",value:"Microsoft JhengHei"},{name:"楷体",value:"KaiTi"},{name:"新宋体",value:"NSimSun"},{name:"仿宋",value:"FangSong"},{name:"幼圆",value:"YouYuan"},{name:"隶书",value:"LiSu"},{name:"苹方",value:"PingFang SC"}],Kt=(0,y.Q2)((({value:e,onChange:t})=>b.createElement(y.Select,{size:"small",value:e,onChange:t,showClear:!0},Wt.map((e=>b.createElement(y.Select.Option,{key:e.name,value:e.value},e.name)))))),Yt=(0,y.Q2)((({value:e,onChange:t,...n})=>n.icon?b.createElement(y.zx,{icon:b.createElement("i",{style:{fontSize:20},className:n.icon}),size:"small",type:e?"primary":"tertiary",theme:e?"solid":"borderless",onClick:()=>{t(!e)}}):n.toggle?b.createElement(b.Fragment,null):b.createElement(y.XZ,{size:"small",checked:e,onChange:()=>t(!e)}))),Gt=(0,y.Q2)((({page:e,value:t,onChange:n})=>b.createElement(ye,{app:"ridge-editor-components",page:e,value:t,input:e=>{n(e)}}))),Xt=(0,y.Q2)((({value:e,onChange:t,options:n})=>{const[i,o]=(0,b.useState)([]);return(0,b.useEffect)((()=>{"function"==typeof n.treeData?n.treeData().then((e=>{o(e.default)})):o(n.treeData)}),[n]),b.createElement(y.mP,{style:{width:250},checkRelation:"unRelated",multiple:!0,leafOnly:!0,value:e,onChange:t,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:i,placeholder:"请选择"})})),Qt=Xt,en=e=>{if(mt.editorComposite){const t=mt.editorComposite.getNodes((t=>t.componentDefinition?.type===e)),n=[];for(const e of t)n.push(e.componentDefinition.classTreeData);return n}return[]},tn=(0,y.Q2)((({value:e,onChange:t})=>b.createElement(y.mP,{size:"small",style:{width:250},checkRelation:"unRelated",multiple:!0,leafOnly:!0,value:e,onChange:t,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:en("style"),placeholder:"请选择"})));function nn(){return nn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},nn.apply(this,arguments)}class on extends b.Component{constructor(e){super(e),this.ref=b.createRef();const{InputNumber:t,Select:n,Checkbox:i,Input:o}=y.Form;this.controlGeneratorMap={divider:e=>b.createElement(y.iz,{margin:"0",align:"center"},e.label),number:(e,n)=>b.createElement(t,{size:"small",label:e.label,disabled:n,innerButtons:!0,field:e.field}),length:(e,n)=>b.createElement(t,{size:"small",label:e.label,disabled:n,field:e.field}),string:(e,t)=>b.createElement(o,{size:"small",label:e.label,field:e.field,disabled:t}),text:(e,t)=>b.createElement(o,{size:"small",label:e.label,field:e.field,disabled:t}),checkbox:(e,t)=>b.createElement(i,{size:"small",label:e.label,field:e.field,disabled:t}),boolean:(e,t)=>b.createElement(Yt,nn({noLabel:null==e.label,label:e.label},e)),select:(e,t)=>b.createElement(n,{size:"small",label:e.label,showClear:!1===e.required,field:e.field,placeholder:e.placeholder,multiple:e.multiple,optionList:e.options||e.optionList,disabled:t}),radiogroup:(e,t)=>b.createElement(Tt,{label:e.label,field:e.field,options:e.optionList||e.options,disabled:t}),fontFamily:(e,t)=>b.createElement(Kt,{label:e.label,field:e.field,disabled:t}),border:(e,t)=>b.createElement(D,{label:e.label,field:e.field,disabled:t}),padding:(e,t)=>b.createElement(Lt,nn({disabled:t},e)),event:(e,t,n)=>b.createElement(Et,{className:"event-field",noLabel:!0,field:e.field,options:{label:e.label,...n}}),image:(e,t)=>b.createElement(Ft,{label:e.label,field:e.field,disabled:t,options:e}),page:(e,t)=>b.createElement(Ft,{label:e.label,field:e.field,disabled:t,options:e}),audio:(e,t)=>b.createElement(Ht,{label:e.label,field:e.field,disabled:t}),font:(e,t)=>b.createElement(Zt,{label:e.label,field:e.field,disabled:t}),background:(e,t)=>b.createElement(Ot,{label:e.label,field:e.field,disabled:t}),colorpicker:(e,t)=>b.createElement(T,{noLabel:!0,label:e.label??"",field:e.field,options:e.presetColors,disabled:t}),color:(e,t)=>b.createElement(T,{noLabel:null==e.label,label:e.label??"",field:e.field,options:e.presetColors,disabled:t}),json:(e,t)=>b.createElement(zt,{label:e.label,field:e.field,disabled:t}),array:e=>b.createElement(_t,{label:e.label,field:e.field,options:e}),class:e=>b.createElement($t,{label:e.label,field:e.field,options:e}),properties:e=>b.createElement(Gt,{noLabel:!0,field:e.field,page:"hi1"}),tree:e=>b.createElement(Qt,{label:e.label,field:e.field,options:e}),style:e=>b.createElement(tn,{label:e.label,field:e.field,options:e})}}getRenderField(e,t,n){return this.controlGeneratorMap[e.control]?this.controlGeneratorMap[e.control](e,t,n):b.createElement("div",null,e.label,"类型不支持",e.control)}renderField(e,t,n,i){if("slot"===e.type||"children"===e.type)return;if("function"==typeof e.hidden?e.hidden(n.values):e.hidden)return;const o="function"==typeof e.readonly?e.readonly(n.values):e.readonly;null==e.control&&(e.control=e.type);const s=this.getRenderField(e,o,i);return"divider"===e.type?b.createElement(y.iz,{key:t,margin:"0",align:"left"},e.label||""):e.fieldEx?b.createElement("div",{key:t,className:"field-block with-code-expr "+(e.width?"":"full-width"),style:{width:e.width||"100%"}},b.createElement("div",{style:{flex:1}},s),b.createElement(gt,{className:"field-code-expr",noLabel:!0,field:e.fieldEx,options:i})):b.createElement("div",{key:t,className:"field-block",style:{width:e.width||"100%"}},s)}render(){const e=this.renderField.bind(this),{fields:t,getFormApi:n,onValueChange:i,style:o,initValues:s,options:r,labelPosition:a="left"}=this.props;return b.createElement("div",{className:"object-form",style:o},b.createElement(y.Form,{size:"small",labelAlign:"right",labelPosition:a,layout:"horizontal",getFormApi:e=>{this.api=e,n&&n(e)},initValues:s,onValueChange:i,render:({formState:n,formApi:i,values:o})=>b.createElement(b.Fragment,null,t&&t.map(((t,i)=>e(t,i,n,r))))}))}}const sn=I()("editor:config-panel"),rn=[{label:"名称",control:"text",bindable:!1,field:"title"}],an=[{label:"距左",control:"number",width:"50%",readonly:e=>e&&(e.full||e.locked),field:"style.x",fieldEx:"styleEx.x"},{label:"距上",width:"50%",control:"number",readonly:e=>e&&(e.full||e.locked),field:"style.y",fieldEx:"styleEx.Y"},{label:"宽度",width:"50%",control:"number",readonly:e=>e&&(e.full||e.locked),field:"style.width",fieldEx:"styleEx.width"},{label:"高度",width:"50%",control:"number",field:"style.height",readonly:e=>e&&(e.full||e.locked),fieldEx:"styleEx.height"},{label:"显示",type:"boolean",control:"checkbox",width:"50%",field:"visible"},{label:"填满",width:"50%",type:"boolean",field:"full"}],ln=[{label:"页面名称",control:"text",readonly:!0,bindable:!1,field:"name"},{label:"宽度",bindable:!1,control:"number",width:"50%",field:"style.width"},{label:"高度",bindable:!1,width:"50%",control:"number",field:"style.height"},{label:"背景",control:"background",field:"style.background"}];class cn extends b.Component{constructor(e){super(e),this.ref=b.createRef(),this.componentPropFormApi=null,this.componentEventFormApi=null,this.pagePropFormApi=null,mt.services.configPanel=this,this.state={configPage:!0,pageFields:[],pageEventFields:[],nodePropFields:[],nodeEventFields:[]}}static contextType=N;componentDidMount(){}componentSelected(e){let t=e;e instanceof Node&&(t=e.view),this.componentView=t,sn("updatePanelConfig",t);const n=[];n.push(...rn),t.getParent()!==mt.editorComposite?n.push(...t.getParent().componentDefinition?.childProps||[]):n.push(...an);const i=[];if(t.componentDefinition){for(const e of t.componentDefinition.props??[]){const t={};e.connect?Object.assign(t,e,{field:"props."+e.name,fieldEx:"propEx."+e.name}):Object.assign(t,e,{field:"props."+e.name}),n.push(t)}for(const e of t.componentDefinition.events??[]){const t={label:e.label,type:"function",control:"event",field:"events."+e.name};i.push(t)}}this.setState({configPage:!1,nodePropFields:n,nodeEventFields:i},(()=>{this.updateComponentConfig(t),this.componentEventFormApi.setValue("events",t.config.events,{notNotify:!0})}))}updateComponentConfig(e){if(e===this.componentView)for(const t of["title","props","propEx","style","styleEx","id","visible","full"])this.componentPropFormApi.setValue(t,e.config[t],{notNotify:!0})}updatePageConfigFields(){const{editorComposite:e}=mt,{appService:t}=mt.services;this.setState({configPage:!0,pageFields:[...ln,{field:"cssFiles",label:"样式表",control:"select",placeholder:"请选择样式文件",optionList:t.filterFiles((e=>"text/css"===e.mimeType)).map((e=>({value:e.path,label:e.label}))),required:!1,multiple:!0},{field:"jsFiles",label:"脚本库",control:"select",placeholder:"请选择脚本文件",optionList:t.filterFiles((e=>"text/javascript"===e.mimeType)).map((e=>({value:e.path,label:e.label}))),required:!1,multiple:!0},{field:"style.classNames",label:"样式库",control:"select",placeholder:"请选择样式",optionList:e.classNames.map((e=>({label:e.label,value:e.className}))),required:!1,multiple:!0}]});const{cssFiles:n,jsFiles:i,style:o,name:s,properties:r}=e.config;this.pagePropFormApi.setValue("cssFiles",n,{notNotify:!0}),this.pagePropFormApi.setValue("properties",r,{notNotify:!0}),this.pagePropFormApi.setValue("jsFiles",i,{notNotify:!0}),this.pagePropFormApi.setValue("style",o,{notNotify:!0}),this.pagePropFormApi.setValue("name",s,{notNotify:!0})}nodeRectChange(e){this.styleChange(e)}render(){const{nodePropFields:e,nodeEventFields:t,pageFields:n,configPage:i}=this.state,o=(e,t)=>{mt.updateComponentConfig(this.componentView,e)};return b.createElement(b.Fragment,null,b.createElement(y.mQ,{type:"card",className:"on-title",style:{display:i?"none":"block"}},b.createElement(y.Jm,{tab:"属性",itemKey:"props"},b.createElement(on,{fields:e,getFormApi:e=>{this.componentPropFormApi=e},onValueChange:(e,t)=>{e.id===this.componentView.config.id&&mt.updateComponentConfig(this.componentView,e)}})),b.createElement(y.Jm,{tab:"交互",itemKey:"interact"},b.createElement(on,{fields:t,getFormApi:e=>{this.componentEventFormApi=e},onValueChange:o}))),b.createElement(y.mQ,{type:"card",className:"on-title",style:{display:i?"block":"none"}},b.createElement(y.Jm,{tab:"基础",itemKey:"style"},b.createElement(on,{fields:n,getFormApi:e=>{this.pagePropFormApi=e},onValueChange:(e,t)=>{mt.editorComposite.updatePageConfig(e)}})),b.createElement(y.Jm,{tab:"交互",itemKey:"interact"},b.createElement(on,{getFormApi:e=>{},onValueChange:o}))))}}function dn(){return dn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dn.apply(this,arguments)}class pn extends b.Component{constructor(){super(),this.state={show:!0}}render(){return b.createElement(L,dn({right:"10px",bottom:"10px",width:"300px",height:"240px"},this.props),b.createElement(cn,null))}}var hn=n(25637),mn=n(52907),gn=n(68267),un=n(90181),fn=n(87188),bn={};bn.styleTagTransform=g(),bn.setAttributes=d(),bn.insert=l().bind(null,"head"),bn.domAPI=r(),bn.insertStyleElement=h(),o()(fn.Z,bn),fn.Z&&fn.Z.locals&&fn.Z.locals;const{Text:vn}=y.Typography,yn=I()("ridge:outline");class wn extends b.Component{constructor(){super(),this.state={componentTreeData:[],expandedKeys:[],selected:null},mt.services.outlinePanel=this}static contextType=N;updateOutline(e){if(e&&this.setState({expandedKeys:[],selected:null}),mt.editorComposite){const e=this.buildElementTree(mt.editorComposite.children);yn("updateOutline",e),this.setState({componentTreeData:e})}}setCurrentNode(e){if(e){let t=this.findNode(this.state.componentTreeData,e.getId());const n=[];for(;t;)n.push(t.key),t=t.parent;this.setState({selected:e.getId(),expandedKeys:Array.from(new Set([...n,...this.state.expandedKeys]))})}else this.setState({selected:null})}findNode(e,t){for(const n of e){if(n.key===t)return n;if(n.children){const e=this.findNode(n.children,t);if(e)return e}}}onNodeSelected(e){const t=mt.getNode(e);t&&t.el&&t.config.visible&&mt.workspaceControl.selectElements([t.el],!0),this.setState({selected:e})}buildElementTree(e){const t=[];for(const n of e)t.push(this.getElementTree(n));return t}getElementTree(e){const t={key:e.getId(),value:e.getId(),label:e.config.title,element:e};return e.componentDefinition&&e.componentDefinition.icon&&(e.componentDefinition.icon.indexOf("/")>-1?t.icon=b.createElement("img",{className:"item-icon",src:e.componentDefinition.icon}):t.icon=b.createElement("i",{className:e.componentDefinition.icon})),e.children&&(t.children=e.children.map((e=>({...this.getElementTree(e),parent:t})))),t}toggleLock=e=>{const t=mt.getNode(e.element);t.setLocked(!t.config.locked),mt.workspaceControl.selectElements([t.el])};toggleVisible=e=>{const t=mt.getNode(e.element);t.setVisible(!t.config.visible),t.config.visible?mt.workspaceControl.selectElements([t.el]):mt.workspaceControl.selectElements([]),this.updateOutline()};renderFullLabel=(e,t)=>{const{toggleLock:n,toggleVisible:i}=this;let{visible:o,locked:s}=t.element.config;return!1!==o&&(o=!0),!0!==s&&(s=!1),b.createElement("div",{className:"tree-label "+(o?"is-visible":"is-hidden")+" "+(s?"is-locked":"")},b.createElement(y.T,{className:"label-content"},b.createElement(vn,{className:"label-text"},e??t.key),t.tags&&t.tags.map((e=>b.createElement(y.Vp,{size:"small",color:"amber",key:e}," ",e," ")))),b.createElement(y.T,{spacing:2},b.createElement(y.zx,{className:s?"":"hover-show",size:"small",theme:"borderless",type:"tertiary",onClick:()=>{n(t)},icon:s?b.createElement(hn.Z,null):b.createElement(mn.Z,null)}),b.createElement(y.zx,{className:o?"hover-show":"",size:"small",theme:"borderless",type:"tertiary",onClick:()=>{i(t)},icon:o?b.createElement(gn.Z,null):b.createElement(un.Z,null)})))};ordering(e,t,n,i){const o=[];for(let s=0;s<e.length;s++)e[s].key===n.key?-1===i?(o.push(t.key),o.push(n.key)):1===i&&(o.push(n.key),o.push(t.key)):e[s].key!==t.key&&o.push(e[s].key);return o}onTreeDrop({event:e,node:t,dragNode:n,dragNodesKeys:i,dropPosition:o,dropToGap:s}){const r=t.pos.split("-"),a=o-Number(r[r.length-1]),l=t.parent?t.parent.element:mt.editorComposite,c=n.parent?n.parent.element:mt.editorComposite;if(!0===s){const e=t.parent?t.parent.children:this.state.componentTreeData,i=this.ordering(e,n,t,a);l!==c&&c.removeChild(n.element),i.length!==e.length&&l.appendChild(n.element),l.updateChildList(i)}else{if(null==t.element.children)return void y.FN.warning({content:"目标节点无法再放入子节点",duration:3});c.removeChild(n.element),t.element.appendChild(n.element)}this.updateOutline(),mt.workspaceControl.selectElements([n.element.el],!0)}render(){const{selected:e,componentTreeData:t,expandedKeys:n}=this.state,{renderFullLabel:i,onTreeDrop:o}=this;return b.createElement(y.mp,{className:"outline-tree",autoExpandWhenDragEnter:!0,draggable:!0,renderLabel:i,onDrop:o.bind(this),onChange:e=>{this.onNodeSelected(e)},onExpand:e=>{this.setState({expandedKeys:e})},expandedKeys:n,value:e,treeData:t})}}const xn=wn;function Cn(){return Cn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Cn.apply(this,arguments)}class En extends b.Component{constructor(){super(),this.state={show:!0}}render(){return b.createElement(L,Cn({right:"10px",bottom:"10px",width:"300px",height:"240px"},this.props),b.createElement(xn,null))}}const kn=()=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 24 24"},b.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 5a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1zm10 0a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1zM4 15a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1zm10 2h6m-3-3v6"})),Sn=n(96292)("ridge:cl"),{Text:Pn}=y.Typography;class zn extends b.Component{constructor(){super(),this.el=document.createElement("div"),this.ref=b.createRef(),this.state={loadedPackages:[],loadedComponents:[],currentPackage:"",fullLoading:!0},mt.services.componentListPanel=this,this.loadedComponents=[]}async ensurePackageComponents(e){for(const t of e.components){const n=e.name+"/"+t;0===this.loadedComponents.filter((e=>e.componentPath===n)).length&&mt.loadComponent(n).then((i=>{i&&(i.packageName=e.name,i.componentName=t,i.componentPath=n,this.loadedComponents.push(i),this.setState({loadedComponents:[...this.loadedComponents]}))}))}}tabChange(e){this.setState({currentPackage:e});const t=this.state.loadedPackages.filter((t=>t.name===e))[0];this.ensurePackageComponents(t)}async loadPackages(){this.setState({fullLoading:!0});const e=await mt.loadPackages();e.length?this.setState({fullLoading:!1,loadedPackages:e,currentPackage:e[0].name}):this.setState({fullLoading:!1}),this.ensurePackageComponents(e[0])}componentDidMount(){this.loadPackages()}dragStart(e,t){mt.draggingComponent=t,window.dragComponent=t,e.dataTransfer.setData("text/plain",JSON.stringify(t));const n=new window.Image;n.src=t.icon,n.style.width="50px",n.style.height="50px";const i=document.createElement("canvas");i.width=i.height=50,i.getContext("2d").drawImage(n,0,0,50,50),Sn("drag start",t,n),e.dataTransfer.setDragImage(i,25,25)}getFilteredComponents(e){const{loadedComponents:t}=this.state;return this.context?t.filter((e=>(e.title||e.label).indexOf(this.context)>-1)):t.filter((t=>t.packageName===e))}renderComponentIcon(e,t){return e?b.createElement("div",{className:"image-icon"},e.indexOf(".")>-1?b.createElement("img",{className:t?"":"img-only",src:e}):b.createElement("i",{className:e}),t&&b.createElement(Pn,null,t," ")):b.createElement(Pn,null,t," ")}render(){const{fullLoading:e,loadedPackages:t,currentPackage:n,loadedComponents:i}=this.state,{dragStart:o,renderComponentIcon:s}=this,r=this.tabChange.bind(this);return b.createElement(b.Fragment,null,e&&b.createElement(y.yC,{size:"large",tip:"等待应用载入"}),!e&&b.createElement(y.mQ,{type:"button",size:"small",tabPosition:"left",tabBarExtraContent:b.createElement("div",{className:"package-icon"},b.createElement(kn,null)),activeKey:n,onChange:e=>r(e)},t.length&&t.map((e=>{let t=b.createElement("div",{className:"package-icon "+e.icon});return t=e.icon?b.createElement("div",{className:"package-icon"},b.createElement("i",{className:e.icon})):b.createElement("div",{className:"package-icon"},e.name.charAt(0)),b.createElement(y.Jm,{style:{padding:"4px"},className:"tab-title",collapsible:!0,tab:t,key:e.name,itemKey:e.name},b.createElement(y.aV,{grid:{gutter:6,span:8},dataSource:e.components,renderItem:t=>{const n=i.filter((n=>n.packageName===e.name&&n.componentName===t))[0];return n?b.createElement(y.aV.Item,null,b.createElement("div",{draggable:!0,onDragStart:t=>o(t,Object.assign(n,{componentPath:e.name+"/"+n.path})),className:"component-container"},s(n.icon,n.title))):b.createElement(y.aV.Item,null,b.createElement("div",{className:"component-container loading"}))}}))}))))}}const Fn=zn;var Nn=n(5900),Ln={};function On(){return On=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},On.apply(this,arguments)}Ln.styleTagTransform=g(),Ln.setAttributes=d(),Ln.insert=l().bind(null,"head"),Ln.domAPI=r(),Ln.insertStyleElement=h(),o()(Nn.Z,Ln),Nn.Z&&Nn.Z.locals&&Nn.Z.locals;class jn extends b.Component{render(){return b.createElement(L,On({},this.props,{className:"component-panel"}),b.createElement(Fn,null))}}const Tn=jn;var Dn=n(1605),An=n(78013),Mn=n(96994),Rn=n(21812),In=n(6377),Zn=n(26451),Vn=n(95687),Bn=n(94015),Un=n(73231),_n=n(95408),qn=n(28969);const Jn=({show:e,value:t,siblingNames:n,change:i,confirm:o,cancel:s})=>{const[r,a]=(0,b.useState)(!0);return b.createElement(y.u_,{title:"重命名",visible:e,onOk:()=>{r&&o()},onCancel:()=>{s()}},b.createElement(y.II,{value:t,validateStatus:r?"":"error",label:"名称",onChange:e=>{i(e),(e=>{const t=ce()(e);a(!0),(""===t||n&&n.indexOf(t)>-1)&&a(!1)})(e)}}))},$n=({show:e,title:t,parentPaths:n,siblingNames:i,confirm:o,cancel:s})=>{const[r,a]=(0,b.useState)(!0),[l,c]=(0,b.useState)("");return b.createElement(y.u_,{title:t||"新增..",visible:e,onOk:()=>{r&&(o(l),c(""))},onCancel:()=>{s(),c("")}},b.createElement(y.Form,{labelPosition:"left",labelAlign:"right",labelWidth:80},b.createElement(y.Form.Input,{disabled:!0,label:"所在目录",initValue:n}),b.createElement(y.Form.Input,{value:l,validateStatus:r?"":"error",label:"名称",onChange:e=>{c(e),(e=>{const t=ce()(e);a(!0),(""===t||i&&i.indexOf(t)>-1)&&a(!1)})(e)}})))},Hn=()=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},b.createElement("path",{fill:"currentColor",d:"M3 1h12.414L21 6.586V23H3V1Zm2 2v18h14V9h-6V3H5Zm10 .414V7h3.586L15 3.414Zm-3.793 8.793L9.414 14l1.793 1.793l-1.414 1.414L6.586 14l3.207-3.207l1.414 1.414Zm3-1.414L17.414 14l-3.207 3.207l-1.414-1.414L14.586 14l-1.793-1.793l1.414-1.414Z"})),Wn=()=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 24 24"},b.createElement("path",{fill:"currentColor",d:"M1 2.5h8.48l2 2.5H23v7h-2V7H10.52l-2-2.5H3V19h11v2H1V2.5ZM21 14v3h3v2h-3v3h-2v-3h-3v-2h3v-3h2Z"})),Kn=()=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 24 24"},b.createElement("path",{fill:"currentColor",d:"M3 1h12.414L21 6.586V12h-2V9h-6V3H5v18h7v2H3V1Zm12 2.414V7h3.586L15 3.414ZM20 14v4h4v2h-4v4h-2v-4h-4v-2h4v-4h2Z"})),Yn=()=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},b.createElement("path",{fill:"currentColor",d:"M12 2.586L17.914 8.5L16.5 9.914l-3.5-3.5V16h-2V6.414l-3.5 3.5L6.086 8.5L12 2.586ZM4.5 14v5h15v-5h2v7h-19v-7h2Z"})),Gn=()=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},b.createElement("path",{fill:"currentColor",d:"M6 1h9.414L21 6.586V19H6V1Zm2 2v14h11V9h-6V3H8Zm7 .414V7h3.586L15 3.414ZM4 5v16h11v2H2V5h2Z"})),Xn=()=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},b.createElement("path",{fill:"currentColor",d:"m16.427 1.963l5.61 5.61L7.61 22.001H2v-5.61L16.427 1.962Zm0 2.828l-2.781 2.782l2.781 2.782l2.782-2.782l-2.782-2.782Zm-1.414 6.978l-2.782-2.782L4 17.22V20h2.782l8.231-8.232Zm7.212 10.232h-9.543v-2h9.543v2Z"}));var Qn=n(30049),ei={};ei.styleTagTransform=g(),ei.setAttributes=d(),ei.insert=l().bind(null,"head"),ei.domAPI=r(),ei.insertStyleElement=h(),o()(Qn.Z,ei),Qn.Z&&Qn.Z.locals&&Qn.Z.locals;const{Text:ti}=y.Typography;class ni extends b.Component{constructor(){super(),this.ref=b.createRef(),this.state={treeData:[],selectedNodeKey:null,dialgeCreateFileType:"",dialogCreateShow:!1,dialogCreateTitle:"",dialogRenameShow:!1,valueRename:""}}componentDidMount(){this.loadAndUpdateFileTree()}async loadAndUpdateFileTree(){const{appService:e}=mt.services;await e.updateAppFileTree();const t=await e.getAppFileTree();this.rebuildTreeIcons(t),this.setState({treeData:t})}rebuildTreeIcons(e){this.nodeMap={},Ae(e,(e=>{this.nodeMap[e.id]=e,e.mimeType&&("application/font-woff"===e.mimeType?e.icon=b.createElement(Dn.Z,{style:{color:"var(--semi-color-text-2)"}}):e.mimeType.indexOf("audio")>-1?e.icon=b.createElement(An.Z,{style:{color:"var(--semi-color-text-2)"}}):e.mimeType.indexOf("image")>-1?e.icon=b.createElement(Mn.Z,{style:{color:"var(--semi-color-text-2)"}}):e.icon=b.createElement(Rn.Z,{style:{color:"var(--semi-color-text-2)"}})),"directory"===e.type&&(e.icon=b.createElement(In.Z,{style:{color:"var(--semi-color-text-2)"}}))}))}getCurrentSiblingNames(){const{selectedNodeKey:e,treeData:t}=this.state;let n=[];if(e){const i=this.nodeMap[e];n=-1===i.parent?t:i.parentNode.children}else n=t;return n.map((e=>e.label))}getCurrentPath(){const{selectedNodeKey:e}=this.state;if(e){const t=this.nodeMap[e];return"directory"===t.type?t.path:t.parentNode?t.parentNode.path:"/"}return"/"}getCurrentParentId(){const{selectedNodeKey:e}=this.state;if(e){const t=this.nodeMap[e];return"directory"===t.type?t.key:t.parent}return-1}showCreateDialog=e=>{this.setState({dialgeCreateFileType:e,dialogCreateShow:!0,dialogCreateTitle:{js:"创建程序文件",page:"创建页面",folder:"创建目录"}[e]})};onCreateConfirm=async e=>{const{dialgeCreateFileType:t}=this.state,{appService:n}=mt.services;try{"page"===t?await n.createComposite(this.getCurrentParentId(),e):"folder"===t?await n.createDirectory(this.getCurrentParentId(),e):"js"===t&&n.createFile(this.getCurrentParentId(),e,Ne("","text/javascript")),this.setState({dialogCreateShow:!1}),this.loadAndUpdateFileTree(),y.FN.success("已经成功创建 "+e)}catch(e){y.FN.success("创建文件失败 "+e)}};onFileUpload=async(e,t)=>{const{appService:n}=mt.services,i=[];for(const t of e)try{await n.createFile(this.getCurrentParentId(),t.name,t)}catch(e){i.push(t)}await this.loadAndUpdateFileTree(),y.FN.success("文件上传完成"),i.length&&y.FN.warning({content:"文件添加错误：存在相同名称文件",duration:3})};onRenameConfirm=async()=>{const{appService:e}=mt.services,{selectedNodeKey:t,valueRename:n}=this.state,i=await e.rename(t,n);mt.onFileRenamed(t,n),i&&(await this.loadAndUpdateFileTree(),this.setState({dialogRenameShow:!1}))};onRemoveClicked=async e=>{y.u_.confirm({zIndex:10001,title:"确认删除",content:"删除后文件无法找回，推荐您可先通过导出进行备份",onOk:async()=>{const{appService:t}=mt.services;await t.deleteFile(e.key),this.setState({selectedNodeKey:null}),this.loadAndUpdateFileTree(),y.FN.success("已经成功删除 "+e.label)}})};onCopyClicked=async e=>{const{appService:t}=mt.services;await t.copy(e.key),this.loadAndUpdateFileTree(),y.FN.success("文件复制完成")};onOpenClicked=e=>{"directory"!==e.type&&mt.openFile(e.key)};onRenameClicked=e=>{this.setState({selectedNodeKey:e.key,dialogRenameShow:!0,valueRename:e.label})};move=async(e,t,n)=>{let i=-1;i=!1===n&&"directory"===e.type?e.key:e.parent;const{appService:o}=mt.services;await o.move(t.key,i)?await this.loadAndUpdateFileTree():y.FN.warning({content:"目录移动错误：存在同名的文件",duration:3})};renderFullLabel=(e,t)=>{const{currentOpenId:n}=this.state,i=[];return"page"===t.type&&i.push(b.createElement(y.Lt.Item,{key:"open",icon:b.createElement(Zn.Z,null),onClick:()=>{this.onOpenClicked(t)}},"打开")),i.push(b.createElement(y.Lt.Item,{key:"copy",icon:b.createElement(Gn,null),onClick:()=>{this.onCopyClicked(t)}},"复制")),i.push(b.createElement(y.Lt.Item,{key:"rename",icon:b.createElement(Xn,null),onClick:()=>{this.onRenameClicked(t)}},"重命名")),i.push(b.createElement(y.Lt.Divider,{key:"div"})),i.push(b.createElement(y.Lt.Item,{key:"delete",type:"danger",icon:b.createElement(Vn.Z,null),onClick:()=>{this.onRemoveClicked(t)}},"删除")),b.createElement("div",{className:"tree-label"+(n===t.key?" opened":"")},b.createElement(ti,{ellipsis:{showTooltip:!0},style:{width:"calc(100% - 48px)"},className:"label-content"},e),b.createElement(y.Lt,{className:"app-files-dropdown",trigger:"click",clickToHide:!0,render:b.createElement(y.Lt.Menu,null,i)},b.createElement(y.zx,{className:"more-button",size:"small",theme:"borderless",type:"tertiary",icon:b.createElement(Bn.Z,{rotate:90})})))};async exportApp(){if(this.state.exportToastId)return;const e=y.FN.info({content:"正在导出应用，请稍侯...",duration:0,onClose:()=>{this.setState({exportToastId:null})}});this.setState({exportToastId:e});const{appService:t}=mt.services;await t.exportAppArchive(),y.FN.close(e),this.setState({exportToastId:null})}renderAppDropDown(){return b.createElement(y.Lt,{trigger:"click",render:b.createElement(y.Lt.Menu,null,b.createElement(y.Lt.Item,{icon:b.createElement(Un.Z,null),onClick:()=>{this.exportApp()}},"导出应用"),b.createElement(y.Lt.Item,{icon:b.createElement(_n.Z,null)},b.createElement(y.gq,{action:"none",accept:".zip",showUploadList:!1,uploadTrigger:"custom",onFileChange:e=>{y.u_.confirm({zIndex:10001,title:"确认导入应用",content:"导入应用会首先覆盖现有应用，如果有需要的工作，建议您首先导出备份。 是否继续?",onOk:()=>{const{appService:t}=mt.services;t.importAppArchive(e[0]).then((e=>{y.FN.info("成功导入应用，共"+e.length+"个文件"),this.loadAndUpdateFileTree()}))}})}},"导入应用")))},b.createElement(y.zx,{size:"small",theme:"borderless",type:"tertiary",icon:b.createElement(qn.Z,null)}))}RenderCreateDropDown=()=>{const{showCreateDialog:e}=this;return b.createElement(y.Lt,{trigger:"click",closeOnEsc:!0,clickToHide:!0,keepDOM:!0,position:"bottomLeft",render:b.createElement(y.Lt.Menu,{className:"app-files-dropdown"},b.createElement(y.Lt.Item,{icon:b.createElement(Kn,null),onClick:()=>e("page")},"创建页面"),b.createElement(y.Lt.Item,{icon:b.createElement(Wn,null),onClick:()=>e("folder")},"创建目录"),b.createElement(y.Lt.Item,{icon:b.createElement(Hn,null),onClick:()=>e("js")},"创建程序文件"),b.createElement(y.Lt.Item,{icon:b.createElement(Yn,null)},b.createElement(y.gq,{action:"none",multiple:!0,showUploadList:!1,uploadTrigger:"custom",onFileChange:e=>{this.onFileUpload(e)},accept:"image/*,video/*,audio/*,.woff,.json,.css,.js"},"上传文件")))},b.createElement(y.zx,{size:"small",theme:"borderless",type:"tertiary",icon:b.createElement(ut.Z,null)}))};render(){const{renderFullLabel:e,state:t,RenderCreateDropDown:n}=this,{treeData:i,dialogCreateShow:o,dialogCreateTitle:s,selectedNodeKey:r,dialogRenameShow:a,valueRename:l}=t;return b.createElement(b.Fragment,null,b.createElement("div",{className:"file-actions"},b.createElement(n,null),this.renderAppDropDown()),b.createElement($n,{show:o,title:s,parentPaths:this.getCurrentPath(),siblingNames:this.getCurrentSiblingNames(),confirm:e=>{this.onCreateConfirm(e)},cancel:()=>{this.setState({dialogCreateShow:!1})}}),b.createElement(Jn,{show:a,value:l,siblingNames:this.getCurrentSiblingNames(),change:e=>{this.setState({valueRename:e})},confirm:()=>{this.onRenameConfirm()},cancel:()=>{this.setState({dialogRenameShow:!1})}}),i&&b.createElement(y.mp,{className:"file-tree",draggable:!0,renderLabel:e,value:r,treeData:i,onDrop:({node:e,dragNode:t,dropPosition:n,dropToGap:i})=>{this.move(e,t,i)},onDoubleClick:(e,t)=>{this.onOpenClicked(t)},onChange:e=>{this.setState({selectedNodeKey:e})}}),!i&&b.createElement("div",{className:"tree-loading"},b.createElement(y.yC,{size:"middle"})))}}const ii=ni;class oi extends b.Component{render(){return b.createElement(L,this.props,b.createElement(ii,null))}}const si=oi;var ri=n(71617),ai=n(92530),li=n(13571);const ci=({value:e,title:t,type:n,visible:i,onChange:o,onClose:s})=>{const r=(0,b.useRef)(null);(0,b.useEffect)((()=>{if(i){let t=null;"text/css"===n&&(t=(0,li.iv)()),"text/javascript"===n&&(t=(0,ai.eJ)()),"text/json"===n&&(t=(0,Pt.AV)()),r.current.editorComposite=new kt.tk({doc:e,extensions:[St.Xy,kt.$f.of([ri.oc]),t,(0,kt.jH)({position:"absolute"})],parent:r.current})}return()=>{r.current.editorComposite&&r.current.editorComposite.destroy()}}),[i,e]);const a=e=>{const t=r.current.editorComposite.state.doc.toString();o(t,e)},l=b.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},b.createElement(y.zx,{style:{marginRight:8},onClick:s},"关闭"),b.createElement(y.zx,{style:{marginRight:8},theme:"solid",onClick:()=>a(!1)},"保存"),b.createElement(y.zx,{theme:"solid",onClick:()=>(a(!0),void(s&&s()))},"保存并关闭"));return b.createElement(y.Uu,{closeOnEsc:!1,size:"large",mask:!1,maskClosable:!1,title:t||"代码编辑",visible:i,footer:l,bodyStyle:{zIndex:1001,overflow:"hidden"},onOk:()=>{const e=r.current.editorComposite.state.doc.toString();o(e)},onCancel:s},b.createElement("div",{style:{border:"1px solid var(--semi-color-border)",overflow:"auto",height:"100%",width:"100%"},className:"code-editor-container",ref:r}))};var di=n(49329),pi={};pi.styleTagTransform=g(),pi.setAttributes=d(),pi.insert=l().bind(null,"head"),pi.domAPI=r(),pi.insertStyleElement=h(),o()(di.Z,pi),di.Z&&di.Z.locals&&di.Z.locals;class hi extends b.Component{constructor(){super(),mt.services.menuBar=this,this.state={pageChanged:!1,zoom:1,treeLocked:!1,containerMask:!0}}setPageChanged(e){this.setState({pageChanged:e})}setZoom(e){this.setState({zoom:e})}zoomChange=e=>{mt.workspaceControl.setZoom(e),this.setZoom(e)};toggleContainerMask=()=>{const e=!this.state.treeLocked;mt.workspaceControl.setDragActive(!e),this.setState({treeLocked:e})};toggoleRunMode=()=>{mt.toggleMode()};savePage=()=>{mt.saveCurrentPage()};render(){const{zoomChange:e,toggleContainerMask:t,toggoleRunMode:n,savePage:i,state:o,props:s}=this,{zoom:r,treeLocked:a,containerMask:l,pageChanged:c}=o,{visible:d}=s;return b.createElement("div",{className:"menu-bar",style:{display:d?"":"none"}},b.createElement(y.T,{className:"bar-content"},b.createElement(y.Ct,{dot:c,type:"danger"},b.createElement(y.zx,{type:"tertiary",icon:b.createElement("i",{className:"bi bi-floppy"}),theme:"borderless",onClick:i})),b.createElement("div",{style:{width:"180px"}},b.createElement(y.iR,{min:10,max:200,marks:{50:"",100:"",150:""},value:100*r,onChange:t=>e(t/100),showBoundary:!1,size:"small"})),b.createElement(y.zx,{theme:"borderless",type:"tertiary",size:"small",style:{width:"54px"}},Math.floor(100*r),"%"),b.createElement(y.iz,{layout:"vertical"}),b.createElement(y.zx,{icon:b.createElement("i",{className:"bi bi-building-lock"}),size:"small",type:a?"primary":"tertiary",theme:a?"solid":"borderless",onClick:t}),b.createElement(y.zx,{type:"tertiary",theme:"borderless",icon:b.createElement("i",{className:"bi bi-x-lg"}),onClick:()=>{this.state.pageChanged?y.u_.confirm({zIndex:10001,title:"注意",content:"页面未保存，是否继续关闭",onOk:async()=>{mt.closeCurrentPage()}}):mt.closeCurrentPage()}},"关闭"),b.createElement(y.zx,{type:"tertiary",theme:"borderless",icon:b.createElement("i",{className:"bi bi-play-fill"}),onClick:()=>{mt.toggleMode()}},"预览")))}}const mi=hi;class gi extends b.Component{constructor(){super(),mt.services.previewBar=this,this.state={width:0,height:0}}toggoleRunMode=()=>{mt.toggleMode(),this.setState({isPreview:!this.state.isPreview})};changeViewPort=(e,t)=>{this.setState({width:e,height:t}),mt.updatePreviewSize(e,t)};onSelectVpChange=e=>{if("config"===e)this.changeViewPort(mt.pageContent.style.width,mt.pageContent.style.height),this.setState({vpName:e,width:mt.pageContent.style.width,height:mt.pageContent.style.height});else{const t=VIEW_PORTS.filter((t=>t.name===e))[0];this.changeViewPort(t.width,t.height),this.setState({vpName:e,width:t.width,height:t.height})}};render(){const{toggoleRunMode:e,state:t,props:n,changeViewPort:i,onSelectVpChange:o}=this,{width:s,height:r,vpName:a,viewPortList:l}=t,{visible:c}=n;return b.createElement("div",{className:"preview-menu-bar",style:{display:c?"":"none"}},b.createElement(y.T,{className:"bar-content",align:"center"},b.createElement(y.zx,{onClick:e},"返回")))}}const ui=gi;var fi=n(11670),bi={};bi.styleTagTransform=g(),bi.setAttributes=d(),bi.insert=l().bind(null,"head"),bi.domAPI=r(),bi.insertStyleElement=h(),o()(fi.Z,bi),fi.Z&&fi.Z.locals&&fi.Z.locals;const vi={ADD:[5,5,0,0,280,450],LEFT_BOTTOM:[5,460,0,8,280,0],PROP:[0,5,5,0,320,540],DATA:[0,550,5,5,320,0]},yi={ADD:[5,5,0,0,280,360],LEFT_BOTTOM:[5,370,0,5,280,0],PROP:[0,5,5,0,280,400],DATA:[0,410,5,5,280,0]};class wi extends b.Component{constructor(e){super(e),this.workspaceRef=b.createRef(),this.viewPortContainerRef=b.createRef(),this.state={editorLoading:!0,componentPanelVisible:!0,propPanelVisible:!1,outlinePanelVisible:!1,appFilePanelVisible:!0,editMenuBarVisible:!1,previewMenuBarVisible:!1,panelPosition:vi,imagePreviewSrc:null,imagePreviewVisible:!1,codeEditTitle:"",codeEditText:"",codeEditVisible:!1,codeEditType:""},window.screen.width<=1366&&(this.state.panelPosition=yi)}componentDidMount(){mt.editorDidMount(this,this.workspaceRef.current,this.viewPortContainerRef.current)}async confirm(e){return new Promise(((t,n)=>{y.u_.confirm({zIndex:10001,title:"确认",content:e,onOk:async()=>{t()},onCancel:()=>{n(new Error)}})}))}setEditorLoaded(){this.setState({editorLoading:!1})}openCodeEditor(e){this.currentEditFile=e,this.setState({codeEditTitle:e.name,codeEditText:e.textContent,codeEditVisible:!0,codeEditType:e.mimeType})}completeCodeEdit(e){mt.onCodeEditComplete(this.currentEditFile.id,e)}openImage(e){this.setState({imagePreviewSrc:e,imagePreviewVisible:!0})}togglePageEdit(){this.setState({componentPanelVisible:!0,appFilePanelVisible:!0,propPanelVisible:!0,editMenuBarVisible:!0,previewMenuBarVisible:!1,outlinePanelVisible:!0})}togglePagePreview(){this.setState({componentPanelVisible:!1,appFilePanelVisible:!1,propPanelVisible:!1,editMenuBarVisible:!1,previewMenuBarVisible:!0,outlinePanelVisible:!1})}togglePageClose(){this.setState({componentPanelVisible:!0,appFilePanelVisible:!0,propPanelVisible:!1,editMenuBarVisible:!1,previewMenuBarVisible:!1,outlinePanelVisible:!1})}render(){const{state:e,workspaceRef:t,viewPortContainerRef:n}=this,{editorLoading:i,componentPanelVisible:o,appFilePanelVisible:s,propPanelVisible:r,outlinePanelVisible:a,panelPosition:l,containerMask:c,editMenuBarVisible:d,previewMenuBarVisible:p,imagePreviewVisible:h,imagePreviewSrc:m,codeEditTitle:g,codeEditText:u,codeEditVisible:f,codeEditType:v}=e;return b.createElement(b.Fragment,null,b.createElement("div",{ref:t,className:"workspace "+(c?"show-container":"")},b.createElement("div",{className:"view-port",ref:n}),!i&&b.createElement(b.Fragment,null,b.createElement(mi,{visible:d}),b.createElement(ui,{visible:p}),b.createElement(Tn,{title:"组件",position:l.ADD,visible:o}),b.createElement(si,{title:"应用资源",position:l.LEFT_BOTTOM,visible:s}),b.createElement(En,{title:"布局导航",position:l.DATA,visible:a}),b.createElement(pn,{position:l.PROP,visible:r}),b.createElement(y.eT,{src:m,visible:h,onVisibleChange:()=>{this.setState({imagePreviewVisible:!1})}}),b.createElement(ci,{title:g,value:u,visible:f,lang:v,onChange:(e,t)=>{this.completeCodeEdit(e,t)},type:v,onClose:()=>{this.setState({codeEditVisible:!1})}}))),i&&b.createElement("div",{className:"editor-loading"},b.createElement(y.yC,{tip:"编辑器已启动.. 正在加载应用资源"})))}}const xi=document.getElementById("root");xi&&(0,v.s)(xi).render(b.createElement(wi,null))},64551:(e,t,n)=>{const i=n(84151),o=n(96292)("ridge:nedb");e.exports=class{constructor(e){this.filename=e,this.store=new i({filename:e,timestampData:!0,autoload:!0})}async compactDatafile(){await this.store.persistence.compactDatafile()}async insert(e){return o("insert",e),new Promise(((t,n)=>{this.store.insert(e,(function(e,i){e?n(e):t(i)}))}))}async update(e,t,n){return o("update",e,t),new Promise(((i,o)=>{let s=e;"string"==typeof e&&(s={_id:e}),this.store.update(s,t,n||{},(function(e,t){e?o(e):i(t)}))}))}async patch(e,t){return o("patch",e,t),"string"==typeof e?this.update({_id:e},{$set:t}):this.update(e,{$set:t})}async clean(){return o("clean"),this.filename,new Promise(((e,t)=>{this.store.remove({},{multi:!0},(function(n,i){n?t(n):e(i)}))}))}async remove(e){if(o("remove",e),"object"==typeof e){if(!Array.isArray(e))return this.doRemove(e);for(const t of e)await this.remove(t)}else if("string"==typeof e)return this.doRemove({_id:e})}async doRemove(e,t){return new Promise(((n,i)=>{this.store.remove(e,t||{multi:!0},(function(e,t){e?i(e):n(t)}))}))}async findOne(e){if("string"==typeof e)return new Promise(((t,n)=>{this.store.findOne({_id:e},(function(e,i){e?n(e):t(i)}))}));{const t=await this.find(e);return t.length>0?t[0]:null}}async find(e,{sort:t,projection:n,skip:i=0,limit:s=-1}={}){return o("db find",e,n),new Promise(((r,a)=>{let l=this.store.find(e);n&&(l=l.projection(n)),t&&(l=l.sort(t)),i&&(l=l.skip(i)),s>0&&(l=l.limit(s)),o("cursor exec",e,n),l.exec((function(e,t){o("cursor exec result ",e,t),e?a(e):(o("found",t),r(t))}))}))}async count(e){return o("count",e),new Promise(((t,n)=>{this.store.count(e,(function(e,i){e?n(e):t(i)}))}))}async exist(e){return o("exist",e),(await this.find(e,{limit:1})).length>0}async distinct(e,t){o("distinct",e,t);const n=await this.find(t);return Array.from(new Set(n.filter((t=>t[e])).map((t=>t[e]))))}}},57053:(e,t,n)=>{"use strict";n.r(t),n.d(t,{basename:()=>m,camelCase:()=>s.a,dirname:()=>h,extname:()=>g,formateDate:()=>p,nanoid:()=>d,trim:()=>a.a});var i=n(72155),o=n(97429),s=n.n(o),r=n(55663),a=n.n(r),l=n(27693),c=n.n(l);const d=(0,i.kP)("1234567890abcdefghijklmnopqrstuvwxyz",10),p=(e,t)=>{const n=e||(new Date).getTime();return c()(n).format(t||"YYYY-MM-DD HH:mm:ss")},h=e=>e.substring(0,e.lastIndexOf("/")),m=(e,t)=>{const n=e.substring(e.lastIndexOf("/")+1);return t?n.substring(0,n.lastIndexOf(t)):n},g=e=>e.substring(e.lastIndexOf("."))},57487:function(e){const t={};"object"==typeof e.exports?e.exports=t:"object"==typeof this&&(this.tarball=t),t.TarReader=class{constructor(){this.fileInfo=[]}readFile(e){return new Promise(((t,n)=>{const i=new FileReader;i.onload=e=>{this.buffer=e.target.result,this.fileInfo=[],this._readFileInfo(),t(this.fileInfo)},i.readAsArrayBuffer(e)}))}readArrayBuffer(e){return this.buffer=e,this.fileInfo=[],this._readFileInfo(),this.fileInfo}_readFileInfo(){this.fileInfo=[];let e=0,t=0,n="",i=null;for(;e<this.buffer.byteLength-512&&(n=this._readFileName(e),0!=n.length);)i=this._readFileType(e),t=this._readFileSize(e),this.fileInfo.push({name:n,type:i,size:t,header_offset:e}),e+=512+512*Math.trunc(t/512),t%512&&(e+=512)}getFileInfo(){return this.fileInfo}_readString(e,t){const n=new Uint8Array(this.buffer,e,t),i=n.indexOf(0);return(new TextDecoder).decode(n.slice(0,i))}_readFileName(e){return this._readString(e,100)}_readFileType(e){const t=new Uint8Array(this.buffer,e+156,1),n=String.fromCharCode(t[0]);return"0"==n?"file":"5"==n?"directory":n}_readFileSize(e){const t=new Uint8Array(this.buffer,e+124,12);let n="";for(let e=0;e<11;e++)n+=String.fromCharCode(t[e]);return parseInt(n,8)}_readFileBlob(e,t,n){const i=new Uint8Array(this.buffer,e,t);return new Blob([i],{type:n})}_readFileBinary(e,t){return new Uint8Array(this.buffer,e,t)}_readTextFile(e,t){const n=new Uint8Array(this.buffer,e,t);return(new TextDecoder).decode(n)}getTextFile(e){const t=this.fileInfo.find((t=>t.name==e));if(t)return this._readTextFile(t.header_offset+512,t.size)}getFileBlob(e,t){const n=this.fileInfo.find((t=>t.name==e));if(n)return this._readFileBlob(n.header_offset+512,n.size,t)}getFileBinary(e){const t=this.fileInfo.find((t=>t.name==e));if(t)return this._readFileBinary(t.header_offset+512,t.size)}},t.TarWriter=class{constructor(){this.fileData=[]}addTextFile(e,t,n){const i=(new TextEncoder).encode(t);this.fileData.push({name:e,array:i,type:"file",size:i.length,dataType:"array",opts:n})}addFileArrayBuffer(e,t,n){const i=new Uint8Array(t);this.fileData.push({name:e,array:i,type:"file",size:i.length,dataType:"array",opts:n})}addFile(e,t,n){this.fileData.push({name:e,file:t,size:t.size,type:"file",dataType:"file",opts:n})}addFolder(e,t){this.fileData.push({name:e,type:"directory",size:0,dataType:"none",opts:t})}_createBuffer(){let e=0;for(let t=0;t<this.fileData.length;t++){const n=this.fileData[t].size;e+=512+512*Math.trunc(n/512),n%512&&(e+=512)}let t=10240*Math.trunc(e/10240);e%10240&&(t+=10240),this.buffer=new ArrayBuffer(t)}async download(e){const t=await this.writeBlob(),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=e,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}async writeBlob(e){return new Blob([await this.write(e)],{type:"application/x-tar"})}write(e){return new Promise(((t,n)=>{this._createBuffer();let i=0,o=0;const s=()=>{if(o++,e&&e(o/this.fileData.length*100),o===this.fileData.length){const e=new Uint8Array(this.buffer);t(e)}};for(let e=0;e<this.fileData.length;e++){const t=this.fileData[e];this._writeFileName(t.name,i),this._writeFileType(t.type,i),this._writeFileSize(t.size,i),this._fillHeader(i,t.opts,t.type),this._writeChecksum(i);const n=new Uint8Array(this.buffer,i+512,t.size);if("array"===t.dataType){for(let e=0;e<t.size;e++)n[e]=t.array[e];s()}else if("file"===t.dataType){const e=new FileReader;e.onload=function(e){const t=e;return function(e){const n=e.target.result,i=new Uint8Array(n);for(let e=0;e<i.length;e++)t[e]=i[e];s()}}(n),e.readAsArrayBuffer(t.file)}else"directory"===t.type&&s();i+=512+512*Math.trunc(t.size/512),t.size%512&&(i+=512)}}))}_writeString(e,t,n){const i=new Uint8Array(this.buffer,t,n),o=new TextEncoder;if(o.encodeInto)for(let t=o.encodeInto(e,i).written;t<n;t++)i[t]=0;else{const t=o.encode(e);for(let e=0;e<n;e++)i[e]=e<t.length?t[e]:0}}_writeFileName(e,t){this._writeString(e,t,100)}_writeFileType(e,t){let n="0";"file"===e?n="0":"directory"===e&&(n="5"),new Uint8Array(this.buffer,t+156,1)[0]=n.charCodeAt(0)}_writeFileSize(e,t){let n=e.toString(8);n=this._leftPad(n,11),this._writeString(n,t+124,12)}_leftPad(e,t){let n=e+"";for(;n.length<t;)n="0"+n;return n}_writeFileMode(e,t){this._writeString(this._leftPad(e,7),t+100,8)}_writeFileUid(e,t){this._writeString(this._leftPad(e,7),t+108,8)}_writeFileGid(e,t){this._writeString(this._leftPad(e,7),t+116,8)}_writeFileMtime(e,t){this._writeString(this._leftPad(e,11),t+136,12)}_writeFileUser(e,t){this._writeString(e,t+265,32)}_writeFileGroup(e,t){this._writeString(e,t+297,32)}_writeChecksum(e){this._writeString("        ",e+148,8);const t=new Uint8Array(this.buffer,e,512);let n=0;for(let e=0;e<512;e++)n+=t[e];this._writeString(n.toString(8),e+148,8)}_getOpt(e,t,n){return null!=e&&null!=e[t]?e[t]:n}_fillHeader(e,t,n){const i=this._getOpt(t,"uid",1e3),o=this._getOpt(t,"gid",1e3),s=this._getOpt(t,"mode","file"===n?"664":"775"),r=this._getOpt(t,"mtime",Date.now()),a=this._getOpt(t,"user","tarballjs"),l=this._getOpt(t,"group","tarballjs");this._writeFileMode(s,e),this._writeFileUid(i.toString(8),e),this._writeFileGid(o.toString(8),e),this._writeFileMtime(Math.trunc(r/1e3).toString(8),e),this._writeString("ustar",e+257,6),this._writeString("00",e+263,2),this._writeFileUser(a,e),this._writeFileGroup(l,e)}}},8731:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,'.moveable-control {\n  width: 8px!important;\n  height: 8px!important;\n  border: 1px solid var(--semi-color-primary)!important;\n  box-sizing: border-box;\n  border-radius: 0!important;\n  background: #fff!important;\n  margin-top: -4px!important;\n  margin-left: -4px!important;\n  z-index: 10;\n}\n.moveable-control-box {\n  z-index: 100!important;\n}\n\n.moveable-line {\n  background: var(--semi-color-primary)!important;\n}\n\n.workspace-movable .moveable-control {\n  width: 18px!important;\n  height: 18px!important;\n  opacity: 0;\n}\n\n.workspace-movable .moveable-line {\n  opacity: 0;\n}\n\n.rCSwd26qe .moveable-line.moveable-vertical.moveable-bold {\n  width: 0.5px!important;\n  background-color: var(--semi-color-warning)!important;\n}\n.rCSwd26qe .moveable-line.moveable-horizontal.moveable-bold {\n  height: 1px!important;\n  background-color: var(--semi-color-warning)!important;\n}\n\n/*\n.rCSwd26qe {\n\tposition: absolute;\n\twidth: 1px;\n\theight: 1px;\n\tleft: 0;\n\ttop: 0;\n    z-index: 3000;\n    --moveable-color: #4af;\n    --zoom: 1;\n    --zoompx: 1px;\n    will-change: transform;\n}\n.rCSwd26qe .moveable-control-box {\n    z-index: 0;\n}\n.rCSwd26qe .moveable-line, .rCSwd26qe .moveable-control {\n    position: absolute;\n\tleft: 0;\n    top: 0;\n    will-change: transform;\n}\n.rCSwd26qe .moveable-control {\n\twidth: 14px;\n\theight: 14px;\n\tborder-radius: 50%;\n\tborder: 2px solid #fff;\n\tbox-sizing: border-box;\n    background: #4af;\n    background: var(--moveable-color);\n\tmargin-top: -7px;\n    margin-left: -7px;\n    border: 2px solid #fff;\n    z-index: 10;\n}\n.rCSwd26qe .moveable-padding {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    width: 100px;\n    height: 100px;\n    transform-origin: 0 0;\n}\n.rCSwd26qe .moveable-line {\n\twidth: 1px;\n    height: 1px;\n    background: #4af;\n    background: var(--moveable-color);\n\ttransform-origin: 0px 50%;\n}\n.rCSwd26qe .moveable-line.moveable-edge {\n    z-index: 1;\n    background: transparent;\n}\n.rCSwd26qe .moveable-line.moveable-dashed {\n    box-sizing: border-box;\n    background: transparent;\n}\n.rCSwd26qe .moveable-line.moveable-dashed.moveable-horizontal {\n    border-top: 1px dashed #4af;\n    border-top-color: #4af;\n    border-top-color: var(--moveable-color);\n}\n.rCSwd26qe .moveable-line.moveable-dashed.moveable-vertical {\n    border-left: 1px dashed #4af;\n    border-left-color: #4af;\n    border-left-color: var(--moveable-color);\n}\n.rCSwd26qe .moveable-line.moveable-vertical {\n    transform: translateX(-50%);\n}\n.rCSwd26qe .moveable-line.moveable-horizontal {\n    transform: translateY(-50%);\n}\n.rCSwd26qe .moveable-line.moveable-vertical.moveable-bold {\n    width: 2px;\n}\n.rCSwd26qe .moveable-line.moveable-horizontal.moveable-bold {\n    height: 2px;\n}\n\n.rCSwd26qe .moveable-control.moveable-origin {\n\tborder-color: #f55;\n\tbackground: #fff;\n\twidth: 12px;\n\theight: 12px;\n\tmargin-top: -6px;\n    margin-left: -6px;\n\tpointer-events: none;\n}\n\n.rCSwd26qe .moveable-direction[data-rotation="0"],  .moveable-view-control-rotation0 {\n\tcursor:ns-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(0deg);transform-origin: 16px 16px"></path></svg>\') 16 16, ns-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="15"],  .moveable-view-control-rotation15 {\n\tcursor:ns-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(15deg);transform-origin: 16px 16px"></path></svg>\') 16 16, ns-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="30"],  .moveable-view-control-rotation30 {\n\tcursor:nesw-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(30deg);transform-origin: 16px 16px"></path></svg>\') 16 16, nesw-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="45"],  .moveable-view-control-rotation45 {\n\tcursor:nesw-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(45deg);transform-origin: 16px 16px"></path></svg>\') 16 16, nesw-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="60"],  .moveable-view-control-rotation60 {\n\tcursor:nesw-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(60deg);transform-origin: 16px 16px"></path></svg>\') 16 16, nesw-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="75"],  .moveable-view-control-rotation75 {\n\tcursor:ew-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(75deg);transform-origin: 16px 16px"></path></svg>\') 16 16, ew-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="90"],  .moveable-view-control-rotation90 {\n\tcursor:ew-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(90deg);transform-origin: 16px 16px"></path></svg>\') 16 16, ew-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="105"],  .moveable-view-control-rotation105 {\n\tcursor:ew-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(105deg);transform-origin: 16px 16px"></path></svg>\') 16 16, ew-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="120"],  .moveable-view-control-rotation120 {\n\tcursor:nwse-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(120deg);transform-origin: 16px 16px"></path></svg>\') 16 16, nwse-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="135"],  .moveable-view-control-rotation135 {\n\tcursor:nwse-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(135deg);transform-origin: 16px 16px"></path></svg>\') 16 16, nwse-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="150"],  .moveable-view-control-rotation150 {\n\tcursor:nwse-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(150deg);transform-origin: 16px 16px"></path></svg>\') 16 16, nwse-resize;\n}\n\n\n.rCSwd26qe .moveable-direction[data-rotation="165"],  .moveable-view-control-rotation165 {\n\tcursor:ns-resize;cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(165deg);transform-origin: 16px 16px"></path></svg>\') 16 16, ns-resize;\n}\n\n.rCSwd26qe .moveable-group {\n    z-index: -1;\n}\n.rCSwd26qe .moveable-area {\n    position: absolute;\n}\n.rCSwd26qe .moveable-area-pieces {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: none;\n}\n.rCSwd26qe .moveable-area.moveable-avoid, .rCSwd26qe .moveable-area.moveable-pass {\n    pointer-events: none;\n}\n.rCSwd26qe .moveable-area.moveable-avoid+.moveable-area-pieces {\n    display: block;\n}\n.rCSwd26qe .moveable-area-piece {\n    position: absolute;\n}\n\n\n.rCSwd26qe {\n    --bounds-color: #d66;\n}\n.rCSwd26qe .moveable-guideline {\n    pointer-events: none;\n    z-index: 2;\n}\n.rCSwd26qe .moveable-guideline.moveable-bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}\n.rCSwd26qe .moveable-guideline-group {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.rCSwd26qe .moveable-guideline-group .moveable-size-value {\n    position: absolute;\n    color: #f55;\n    font-size: 12px;\n    font-weight: bold;\n}\n.rCSwd26qe .moveable-guideline-group.moveable-horizontal .moveable-size-value {\n    transform-origin: 50% 100%;\n    transform: translateX(-50%);\n    left: 50%;\n    bottom: 5px;\n}\n.rCSwd26qe .moveable-guideline-group.moveable-vertical .moveable-size-value {\n    transform-origin: 0% 50%;\n    top: 50%;\n    transform: translateY(-50%);\n    left: 5px;\n}\n.rCSwd26qe .moveable-guideline.moveable-gap {\n    background: #f55;\n}\n.rCSwd26qe .moveable-size-value.moveable-gap {\n    color: #f55;\n}\n\n.rCSwd26qe .moveable-edge.moveable-edgeDraggable.moveable-line {\n    cursor: move;\n}\n.rCSwd26qe .moveable-rotation {\n    position: absolute;\n    height: 40px;\n    width: 1px;\n    transform-origin: 50% 100%;\n    height: calc(40px * var(--zoom));\n    top: auto;\n    left: 0;\n    bottom: 100%;\n    will-change: transform;\n}\n\n*/',""]);const a=r},11670:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,"html,\nbody {\n  overflow: hidden;\n  overflow-y: hidden!important;\n  user-select: none;\n  background-color: var(--semi-color-bg-0) !important;\n  width: 100%;\n  height: 100%;\n}\n#root {\n  height: 100%;\n  width: 100%;\n}\n:focus-visible {\n  outline: none;\n}\n::-webkit-scrollbar,\n::-webkit-scrollbar-thumb {\n  width: 12px;\n  height: 12px;\n  border-radius: 20px;\n  background-clip: padding-box;\n  border: 2px solid transparent;\n  color: var(--semi-color-fill-2);\n}\n::-webkit-scrollbar-thumb:hover {\n  color: var(--semi-color-fill-2);\n}\n::-webkit-scrollbar-thumb:active {\n  color: var(--semi-color-fill-2);\n}\n::-webkit-scrollbar-thumb {\n  box-shadow: inset 0 0 0 10px;\n}\n::-webkit-scrollbar-corner {\n  display: none;\n}\n.workspace {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background: var(--semi-color-fill-1);\n}\n.workspace .viewport-container {\n  background-color: var(--semi-color-bg-0);\n}\n.workspace .viewport-container.preview-full {\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n}\n.workspace.show-container .ridge-container {\n  background-color: #97d5ff30;\n}\n.workspace.show-container .ridge-droppable {\n  background-color: #97d5ff30;\n}\n.workspace .ridge-element-edit:has(.ridge-element-edit:hover) {\n  outline: none;\n}\n.workspace .ridge-element-edit.selected:hover {\n  outline: none;\n}\n.workspace .ridge-element-edit:hover {\n  outline: 1px dashed var(--semi-color-secondary);\n  outline-offset: 2px;\n}\n.workspace .ridge-element-edit:hover:has(.drop-shadow) {\n  outline: none;\n  outline-offset: 2px;\n}\n.workspace .store-component {\n  color: #037adb;\n  border: 1px solid #9eeaf9;\n  background: #cff4fc;\n  display: flex;\n  padding: 6px;\n  border-radius: 6px;\n  gap: 10px;\n  font-size: 14px;\n}\n.status-drag-over {\n  z-index: 0;\n  background-color: var(--semi-color-primary-light-default);\n  border: 2px dashed var(--semi-color-primary);\n}\nslot {\n  position: relative;\n}\n.pop-code-editor-container {\n  width: 420px;\n  margin: 5px 0;\n  height: 240px;\n  overflow: auto;\n  position: relative;\n  background: var(--semi-color-bg-0);\n  border: 1px solid var(--semi-color-border);\n}\n.tree-label {\n  display: flex;\n  margin-left: 5px;\n}\n.tree-label .label-content {\n  flex: 1;\n  height: 24px;\n}\n.tree-label .label-action {\n  display: none;\n}\n.tree-label:hover .label-action {\n  display: initial;\n}\n.tree-label:hover .hover-show {\n  visibility: initial;\n}\n.tree-label .hover-show {\n  visibility: hidden;\n}\n.editor-loading {\n  position: absolute;\n  z-index: 10001;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: var(--semi-color-bg-3);\n}\n.editor-loading .semi-spin {\n  width: 300px;\n}\n",""]);const a=r},18042:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,"/**sketch拾取*/\n.sketch-picker {\n  border-radius: 5px;\n  box-shadow: none!important;\n  padding: 0!important;\n}\n/*输入边距Pop*/\n.input-padding-pop {\n  background-color: var(--semi-color-bg-0);\n  height: 100px;\n  width: 280px;\n}\n/*输入边距*/\n.input-padding {\n  position: relative;\n  top: 30px;\n  left: 10px;\n  margin: 0 40px 15px 25px;\n  border: 1px solid #ece;\n  height: 40px;\n  width: 200px;\n}\n.input-padding.position-border .order-0 {\n  left: 50%;\n  margin-left: -35px;\n  top: -12px;\n}\n.input-padding.position-border .order-1 {\n  left: 100%;\n  margin-left: -25px;\n  top: 5px;\n}\n.input-padding.position-border .order-2 {\n  left: 50%;\n  margin-left: -35px;\n  top: 28px;\n}\n.input-padding.position-border .order-3 {\n  left: 0;\n  margin-left: -25px;\n  top: 5px;\n}\n.input-padding.position-corner .order-0 {\n  left: 0;\n  margin-left: -25px;\n  top: -15px;\n}\n.input-padding.position-corner .order-1 {\n  left: 100%;\n  margin-left: -25px;\n  top: -15px;\n}\n.input-padding.position-corner .order-2 {\n  left: 100%;\n  margin-left: -25px;\n  top: 28px;\n}\n.input-padding.position-corner .order-3 {\n  left: 0;\n  margin-left: -25px;\n  top: 28px;\n}\n.input-padding .input-padding-number {\n  position: absolute;\n  background-color: var(--semi-color-bg-0);\n  width: 60px;\n}\n.event-edit {\n  width: 100%;\n  border-radius: 10px;\n  border: 1px solid var(--semi-color-border);\n}\n.semi-portal img,\n.semi-portal svg {\n  vertical-align: initial;\n}\n.object-form {\n  padding: 0 3px;\n  height: 100%;\n  overflow-y: overlay;\n}\n.object-form img,\n.object-form svg {\n  vertical-align: initial;\n}\n.object-form .semi-form-horizontal .semi-form-field:last-child {\n  margin-right: 2px;\n}\n.object-form .semi-form-horizontal .semi-form-field {\n  padding-right: 2px;\n}\n.object-form .semi-table-wrapper table thead {\n  display: none;\n}\n.object-form .semi-table-wrapper table .semi-table-tbody > .semi-table-row .btn-code {\n  visibility: hidden;\n}\n.object-form .semi-table-wrapper table .semi-table-tbody > .semi-table-row .btn-code.semi-button-primary {\n  visibility: visible;\n}\n.object-form .semi-table-wrapper table .semi-table-tbody > .semi-table-row:hover .btn-code {\n  visibility: visible;\n}\n.object-form .semi-table-wrapper table td.semi-table-row-cell {\n  padding: 4px 2px;\n}\n.object-form .semi-table-wrapper table td.semi-table-row-cell .semi-form-field {\n  padding: 0;\n}\n.object-form .semi-form .semi-form-field-label {\n  margin-bottom: 0;\n  margin-right: 0;\n  padding-top: 0px;\n  min-width: 44px;\n  line-height: 26px;\n  padding-bottom: 0px;\n  font-weight: normal;\n  color: var(--semi-color-text-2);\n}\n.object-form .semi-form .field-block {\n  padding: 4px 0;\n}\n.object-form .semi-form .with-code-expr {\n  display: flex;\n}\n.object-form .semi-form .with-code-expr .semi-button-tertiary.btn-code {\n  visibility: hidden;\n}\n.object-form .semi-form .with-code-expr .semi-button-tertiary.btn-code.semi-button-primary {\n  visibility: initial;\n}\n.object-form .semi-form .with-code-expr .semi-button-tertiary.is-open {\n  visibility: initial;\n}\n.object-form .semi-form .with-code-expr:hover .semi-button-tertiary.btn-code {\n  visibility: initial;\n}\n.object-form .semi-form .semi-form-field-main > .semi-checkbox {\n  padding: 2px;\n}\n.object-form .semi-form .semi-divider_inner-text {\n  font-size: 14px;\n  font-weight: normal;\n  color: var(--semi-color-text-1);\n}\n.object-form .semi-form .semi-form-field .semi-checkboxGroup-horizontal-cardType {\n  padding-top: 0;\n  padding-bottom: 0;\n  gap: 4px;\n}\n.object-form .semi-form .semi-form-field .semi-checkboxGroup-horizontal-cardType .semi-checkbox {\n  padding: 2px 4px;\n}\n.object-form .semi-form .semi-form-field .semi-checkboxGroup-horizontal-cardType .semi-checkbox .semi-checkbox-addon {\n  font-weight: normal;\n}\n.object-form .semi-form .semi-form-field .semi-radio-addon-buttonRadio-small {\n  padding: 2px 4px;\n}\n.object-form .semi-form .semi-form-field .semi-checkboxGroup-horizontal-pureCardType .semi-checkbox {\n  column-gap: 0;\n  align-items: center;\n  padding: 2px 5px;\n}\n.object-form .state-list-edit {\n  display: flex;\n}\n.object-form .state-list-edit .state-list {\n  flex: 1;\n}\n.object-form .state-list-edit .state-list .list-item {\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n}\n.object-form .state-list-edit .state-list .list-item:hover {\n  background-color: var(--semi-color-fill-1);\n}\n.object-form .state-list-edit .state-list .list-item.is-current {\n  border: 1px solid var(--semi-color-info-light-active);\n  background-color: var(--semi-color-info-light-default);\n}\n.object-form .state-list-edit .state-list .list-item .state-name {\n  padding: 0 5px;\n}\n.object-form .background-edit {\n  display: flex;\n}\n.object-form .background-edit .color-list {\n  flex: 1;\n}\n.object-form .semi-input-number.digit2 {\n  width: 46px;\n}\n.object-form .semi-input-wrapper .semi-input {\n  padding-left: 6px;\n  padding-right: 6px;\n}\n.object-form .semi-input-wrapper .semi-input-append {\n  padding: 0 5px;\n}\n.object-form .semi-input-textarea-wrapper .semi-input-textarea {\n  padding: 0;\n  padding-left: 6px;\n  padding-right: 6px;\n}\n.object-form .semi-input-number-suffix-btns {\n  margin-left: 1px;\n}\n.object-form .picker-button {\n  font-size: 20px;\n  width: 21px;\n  cursor: pointer;\n}\n.pop-icon-container .icon-list {\n  width: 420px;\n  height: 330px;\n  overflow: auto;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 5px;\n}\n.pop-icon-container .icon-list i {\n  cursor: pointer;\n  color: var(--semi-color-tertiary-hover);\n  padding: 5px;\n  width: 40px;\n  height: 40px;\n  font-size: 24px;\n}\n.pop-icon-container .icon-list i:hover {\n  color: var(--semi-color-primary-hover);\n}\n.series-table-edit {\n  border: 1px solid var(--semi-color-border);\n  border-collapse: collapse;\n  font-size: 14px;\n  border-right: none;\n  border-bottom: none;\n}\n.series-table-edit th {\n  background-color: var(--semi-color-fill-1);\n}\n.series-table-edit th:nth-child(1),\n.series-table-edit td:nth-child(1),\n.series-table-edit th.column-plus {\n  background-color: var(--semi-color-fill-1);\n  width: 28px;\n  min-width: 28px;\n}\n.series-table-edit td.row-delete {\n  padding: 0 5px;\n  width: 28px;\n  min-width: 28px;\n  line-height: 14px;\n  color: var(--semi-color-danger);\n  border: none;\n  display: none;\n}\n.series-table-edit td.column-delete {\n  line-height: 14px;\n  cursor: pointer;\n  color: var(--semi-color-danger);\n}\n.series-table-edit tr:hover td.row-delete {\n  width: 28px;\n  border: none;\n  min-width: 28px;\n  cursor: pointer;\n  display: table-cell;\n}\n.series-table-edit td,\n.series-table-edit th {\n  border: 1px solid var(--semi-color-border);\n  padding: 0.1rem 0.5rem;\n  vertical-align: middle;\n  min-width: 60px;\n}\n.series-table-edit th.column-plus,\n.series-table-edit td.row-plus {\n  cursor: pointer;\n}\n.series-table-edit th.column-plus:hover,\n.series-table-edit td.row-plus:hover {\n  background-color: var(--semi-color-fill-0);\n}\n",""]);const a=r},5900:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,".component-panel .package-icon {\n  width: 22px;\n  height: 22px;\n  font-size: 22px;\n  color: var(--semi-color-text-0);\n  text-align: center;\n}\n.component-panel .package-icon img {\n  object-fit: contain;\n  width: 22px;\n  height: 22px;\n}\n.component-panel .semi-tabs-bar-left .semi-tabs-tab {\n  padding: 6px;\n}\n.component-panel .component-container {\n  margin: 5px 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  width: 100%;\n  border-radius: 8px;\n  height: 70px;\n  background-color: var(--semi-color-tertiary-light-default);\n  cursor: pointer;\n}\n.component-panel .component-container:hover {\n  background-color: var(--semi-color-primary-light-hover);\n}\n.component-panel .component-container i {\n  font-size: 2em;\n  margin-bottom: 5px;\n}\n.component-panel .component-container .image-icon {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  flex: 1;\n}\n.component-panel .component-container .image-icon img.img-only {\n  width: 44px;\n  height: auto;\n  margin-bottom: 0;\n}\n.component-panel .component-container .image-icon img {\n  width: 32px;\n  height: 32px;\n  margin-bottom: 5px;\n}\n.component-panel .component-container .component-icon {\n  width: 36px;\n  height: 36px;\n  -webkit-mask-size: 36px auto;\n  background: linear-gradient(145deg, #8cb8ff, #1c85ff);\n  background-size: cover;\n  background-repeat: no-repeat;\n}\n.component-panel .component-container .font-icon {\n  font-size: 28px;\n  padding-top: 6px;\n  height: 40px;\n  text-align: center;\n  color: var(--semi-color-secondary);\n}\n.component-add-panel .package-tab {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  box-sizing: border-box;\n  padding: 0 2px;\n}\n.component-add-panel .semi-tabs-bar-button .semi-tabs-tab {\n  padding: 8px 3px;\n}\n.component-add-panel .package-tab img {\n  width: 24px;\n  height: 24px;\n}\n",""]);const a=r},30049:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,".file-actions {\n  display: flex;\n  position: absolute;\n  z-index: 10;\n  right: 10px;\n  top: 6px;\n}\n.file-actions .align-right {\n  gap: 5px;\n  flex: 1;\n  display: flex;\n  justify-content: flex-end;\n}\n.tree-loading {\n  height: calc(100% - 26px);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n}\n.file-tree {\n  height: calc(100% - 26px);\n  overflow: auto;\n}\n.file-tree .icon-image {\n  width: 18px;\n  height: 18px;\n  margin-right: 8px;\n  object-fit: contain;\n}\n.file-tree .tree-label {\n  display: flex;\n  align-items: center;\n}\n.file-tree .tree-label.opened .label-content {\n  color: var(--semi-color-success);\n  font-weight: bold;\n}\n.file-tree .tree-label .label-content {\n  flex: 1;\n}\n.file-tree .tree-label .more-button {\n  visibility: hidden;\n  margin-right: 5px;\n}\n.file-tree .tree-label:hover .more-button {\n  visibility: inherit;\n}\n.app-files-dropdown svg {\n  width: 1.2em;\n  height: 1.2em;\n}\n",""]);const a=r},49329:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,".menu-bar {\n  position: absolute;\n  left: 5px;\n  right: 5px;\n  bottom: 5px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.menu-bar .bar-content {\n  background: var(--semi-color-bg-0);\n  border: 1px solid var(--semi-color-border);\n  padding: 8px;\n  border-radius: 8px;\n  z-index: 101;\n}\n.menu-bar .bar-content .bi {\n  font-size: 16px;\n}\n.menu-bar .semi-slider-handle {\n  width: 16px;\n  height: 16px;\n  margin-top: 8px;\n}\n.preview-menu-bar {\n  position: absolute;\n  right: 5px;\n  top: 5px;\n}\n",""]);const a=r},44426:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,".movable-panel {\n  position: absolute;\n  background: var(--semi-color-bg-0);\n  border: 1px solid var(--semi-color-border);\n  padding: 4px;\n  border-radius: 5px;\n  z-index: 300;\n}\n.movable-panel .semi-spin {\n  width: 100%;\n  height: 100%;\n}\n.movable-panel .title-bar {\n  position: relative;\n  height: 1px;\n  z-index: 1;\n  height: 32px;\n}\n.movable-panel .title-bar .title-text {\n  position: absolute;\n  left: 33px;\n  top: 5px;\n}\n.movable-panel .title-bar .toggle-search {\n  z-index: 101;\n  background-color: var(--semi-color-bg-2);\n}\n.movable-panel .title-bar .toggle-search .semi-input-suffix {\n  cursor: pointer;\n}\n.movable-panel .title-bar .icon-handle {\n  position: absolute;\n  top: 7px;\n  left: 7px;\n  cursor: move;\n  color: var(--semi-color-text-0);\n}\n.movable-panel .title-bar .icon-search {\n  position: absolute;\n  top: 2px;\n  right: 5px;\n}\n.movable-panel .title-bar .icon-close {\n  position: absolute;\n  top: 2px;\n  right: 5px;\n}\n.movable-panel .panel-content {\n  height: calc(100% - 32px);\n}\n.movable-panel .semi-tabs-top {\n  height: 100%;\n}\n.movable-panel .semi-tabs-top.on-title .semi-tabs-bar {\n  position: absolute;\n  top: -30px;\n  left: 36px;\n  right: 10px;\n  z-index: 9;\n}\n.movable-panel .semi-tabs-top .semi-tabs-bar .semi-tabs-tab {\n  padding: 3px 5px;\n}\n.movable-panel .semi-tabs-top .semi-tabs-bar .semi-tabs-tab.semi-tabs-tab-active {\n  padding: 3px 5px;\n}\n.movable-panel .semi-tabs-top .semi-tabs-content {\n  height: calc(100% - 24px);\n}\n.movable-panel .semi-tabs-top .semi-tabs-content .semi-tabs-pane {\n  height: 100%;\n}\n.movable-panel .semi-tabs-top .semi-tabs-content .semi-tabs-pane .semi-tabs-pane-motion-overlay {\n  height: 100%;\n}\n.movable-panel .semi-tabs-top.on-title .semi-tabs-content {\n  height: 100%;\n}\n.movable-panel .semi-tabs-left {\n  height: 100%;\n}\n.movable-panel.open-search .semi-tabs.on-title .semi-tabs-bar {\n  display: none;\n}\n",""]);const a=r},87188:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,".outline-tree {\n  height: 100%;\n  overflow: auto;\n}\n.outline-tree img.item-icon {\n  width: 18px;\n  height: 18px;\n  margin-right: 6px;\n}\n.outline-tree .semi-tree-option-label:has(.is-hidden) {\n  opacity: 0.6;\n}\n.outline-tree .tree-label.is-hidden {\n  opacity: 0.6;\n}\n",""]);const a=r},72801:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,"html,\nbody,\ndiv,\nspan,\napplet,\nobject,\niframe,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\np,\nblockquote,\npre,\na,\nabbr,\nacronym,\naddress,\nbig,\ncite,\ncode,\ndel,\ndfn,\nem,\nimg,\nins,\nkbd,\nq,\ns,\nsamp,\nsmall,\nstrike,\nstrong,\nsub,\nsup,\ntt,\nvar,\nb,\nu,\ni,\ncenter,\ndl,\ndt,\ndd,\nmenu,\nol,\nul,\nli,\nfieldset,\nform,\nlabel,\nlegend,\ntable,\ncaption,\ntbody,\ntfoot,\nthead,\ntr,\nth,\ntd,\narticle,\naside,\ncanvas,\ndetails,\nembed,\nfigure,\nfigcaption,\nfooter,\nheader,\nhgroup,\nmain,\nmenu,\nnav,\noutput,\nruby,\nsection,\nsummary,\ntime,\nmark,\naudio,\nvideo {\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font-size: 100%;\n  font: inherit;\n  vertical-align: baseline!important;\n  box-sizing: border-box;\n}\n/* HTML5 display-role reset for older browsers */\narticle,\naside,\ndetails,\nfigcaption,\nfigure,\nfooter,\nheader,\nhgroup,\nmain,\nmenu,\nnav,\nsection {\n  display: block;\n}\n/* HTML5 hidden-attribute fix for newer browsers */\n*[hidden] {\n  display: none;\n}\nbody {\n  line-height: 1;\n}\nmenu,\nol,\nul {\n  list-style: none;\n}\nblockquote,\nq {\n  quotes: none;\n}\nblockquote:before,\nblockquote:after,\nq:before,\nq:after {\n  content: '';\n  content: none;\n}\ntable {\n  border-collapse: collapse;\n  border-spacing: 0;\n}\nbody {\n  margin: 0;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;\n}\ncode {\n  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New', monospace;\n}\ninput[type='color'] {\n  width: 26px;\n  height: 28px;\n  border: none;\n  cursor: pointer;\n  background: transparent;\n  appearance: none;\n  padding: 0;\n}\n.dialog-resource {\n  width: 80%;\n}\n",""]);const a=r},49601:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s)()(o());r.push([e.id,'/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */\n\n/* Document\n   ========================================================================== */\n\n/**\n * 1. Correct the line height in all browsers.\n * 2. Prevent adjustments of font size after orientation changes in iOS.\n */\n\nhtml {\n  line-height: 1.15; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n}\n\n/* Sections\n   ========================================================================== */\n\n/**\n * Remove the margin in all browsers.\n */\n\nbody {\n  margin: 0;\n}\n\n/**\n * Render the `main` element consistently in IE.\n */\n\nmain {\n  display: block;\n}\n\n/**\n * Correct the font size and margin on `h1` elements within `section` and\n * `article` contexts in Chrome, Firefox, and Safari.\n */\n\nh1 {\n  font-size: 2em;\n  margin: 0.67em 0;\n}\n\n/* Grouping content\n   ========================================================================== */\n\n/**\n * 1. Add the correct box sizing in Firefox.\n * 2. Show the overflow in Edge and IE.\n */\n\nhr {\n  box-sizing: content-box; /* 1 */\n  height: 0; /* 1 */\n  overflow: visible; /* 2 */\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\npre {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/* Text-level semantics\n   ========================================================================== */\n\n/**\n * Remove the gray background on active links in IE 10.\n */\n\na {\n  background-color: transparent;\n}\n\n/**\n * 1. Remove the bottom border in Chrome 57-\n * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.\n */\n\nabbr[title] {\n  border-bottom: none; /* 1 */\n  text-decoration: underline; /* 2 */\n  text-decoration: underline dotted; /* 2 */\n}\n\n/**\n * Add the correct font weight in Chrome, Edge, and Safari.\n */\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\ncode,\nkbd,\nsamp {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/**\n * Add the correct font size in all browsers.\n */\n\nsmall {\n  font-size: 80%;\n}\n\n/**\n * Prevent `sub` and `sup` elements from affecting the line height in\n * all browsers.\n */\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/* Embedded content\n   ========================================================================== */\n\n/**\n * Remove the border on images inside links in IE 10.\n */\n\nimg {\n  border-style: none;\n}\n\n/* Forms\n   ========================================================================== */\n\n/**\n * 1. Change the font styles in all browsers.\n * 2. Remove the margin in Firefox and Safari.\n */\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  line-height: 1.15; /* 1 */\n  margin: 0; /* 2 */\n}\n\n/**\n * Show the overflow in IE.\n * 1. Show the overflow in Edge.\n */\n\nbutton,\ninput { /* 1 */\n  overflow: visible;\n}\n\n/**\n * Remove the inheritance of text transform in Edge, Firefox, and IE.\n * 1. Remove the inheritance of text transform in Firefox.\n */\n\nbutton,\nselect { /* 1 */\n  text-transform: none;\n}\n\n/**\n * Correct the inability to style clickable types in iOS and Safari.\n */\n\nbutton,\n[type="button"],\n[type="reset"],\n[type="submit"] {\n  -webkit-appearance: button;\n}\n\n/**\n * Remove the inner border and padding in Firefox.\n */\n\nbutton::-moz-focus-inner,\n[type="button"]::-moz-focus-inner,\n[type="reset"]::-moz-focus-inner,\n[type="submit"]::-moz-focus-inner {\n  border-style: none;\n  padding: 0;\n}\n\n/**\n * Restore the focus styles unset by the previous rule.\n */\n\nbutton:-moz-focusring,\n[type="button"]:-moz-focusring,\n[type="reset"]:-moz-focusring,\n[type="submit"]:-moz-focusring {\n  outline: 1px dotted ButtonText;\n}\n\n/**\n * Correct the padding in Firefox.\n */\n\nfieldset {\n  padding: 0.35em 0.75em 0.625em;\n}\n\n/**\n * 1. Correct the text wrapping in Edge and IE.\n * 2. Correct the color inheritance from `fieldset` elements in IE.\n * 3. Remove the padding so developers are not caught out when they zero out\n *    `fieldset` elements in all browsers.\n */\n\nlegend {\n  box-sizing: border-box; /* 1 */\n  color: inherit; /* 2 */\n  display: table; /* 1 */\n  max-width: 100%; /* 1 */\n  padding: 0; /* 3 */\n  white-space: normal; /* 1 */\n}\n\n/**\n * Add the correct vertical alignment in Chrome, Firefox, and Opera.\n */\n\nprogress {\n  vertical-align: baseline;\n}\n\n/**\n * Remove the default vertical scrollbar in IE 10+.\n */\n\ntextarea {\n  overflow: auto;\n}\n\n/**\n * 1. Add the correct box sizing in IE 10.\n * 2. Remove the padding in IE 10.\n */\n\n[type="checkbox"],\n[type="radio"] {\n  box-sizing: border-box; /* 1 */\n  padding: 0; /* 2 */\n}\n\n/**\n * Correct the cursor style of increment and decrement buttons in Chrome.\n */\n\n[type="number"]::-webkit-inner-spin-button,\n[type="number"]::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/**\n * 1. Correct the odd appearance in Chrome and Safari.\n * 2. Correct the outline style in Safari.\n */\n\n[type="search"] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/**\n * Remove the inner padding in Chrome and Safari on macOS.\n */\n\n[type="search"]::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/**\n * 1. Correct the inability to style clickable types in iOS and Safari.\n * 2. Change font properties to `inherit` in Safari.\n */\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/* Interactive\n   ========================================================================== */\n\n/*\n * Add the correct display in Edge, IE 10+, and Firefox.\n */\n\ndetails {\n  display: block;\n}\n\n/*\n * Add the correct display in all browsers.\n */\n\nsummary {\n  display: list-item;\n}\n\n/* Misc\n   ========================================================================== */\n\n/**\n * Add the correct display in IE 10+.\n */\n\ntemplate {\n  display: none;\n}\n\n/**\n * Add the correct display in IE 10.\n */\n\n[hidden] {\n  display: none;\n}\n',""]);const a=r},45047:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(54933),o=n.n(i),s=n(93476),r=n.n(s),a=n(91678),l=n.n(a),c=new URL(n(49878),n.b),d=r()(o()),p=l()(c);d.push([e.id,`html, body {\n    user-select: none;\n    -webkit-tap-highlight-color: none;\n    width: 100%;\n    height: 100%;\n}\n\n:focus-visible {\n  outline: none;\n}\n\n.ridge-composite {\n    position: relative;\n}\n\n.ridge-composite > .ridge-element {\n    position: absolute;\n    left: 0;\n    top: 0;\n}\n\n.ridge-is-full {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n}\n\n.ridge-is-hidden {\n    display: none;\n}\n\n.ridge-overlay {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n}\n\n.status-Loading {\n    background: linear-gradient(90deg,#2e32380d 25%,#2e323817 44%,#2e32380d 88%);\n    background-size: 400% 100%;\n    animation: skeleton-loading 3s ease infinite;\n    animation-fill-mode: forwards;\n}\n\n.status-not-found {\n    background-color: rgba(253, 185, 165, .3);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    color: rgba(142, 8, 5);\n\n    background-size: 30%;\n    background-repeat: no-repeat;\n    background-position: center;\n    background-image: url(${p});\n}\n\n.ridge-composite:not(.is-edit) .is-store {\n    display: none;\n}\n@keyframes skeleton-loading {\n    0% {\n        background-position: 100% 50%\n    }\n\n    to {\n        background-position: 0 50%\n    }\n}`,""]);const h=d},49878:e=>{"use strict";e.exports='data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="14" height="14" viewBox="0 0 14 14"%3E%3Cpath fill="none" stroke="rgba%28142%2C 8%2C 5%2C 0.5%29" stroke-linecap="round" stroke-linejoin="round" d="m8.54 9.7l2-2l2.12-2.12a3 3 0 0 0 0-4.24h0a3 3 0 0 0-4.24 0L7 2.76L5.46 4.3M3.5 6.26L1.38 8.38a3 3 0 0 0 0 4.24h0a3 3 0 0 0 4.24 0l1-1M4.17 2.05l5.66 9.9"%2F%3E%3C%2Fsvg%3E'}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.m=t,e=[],i.O=(t,n,o,s)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,o,s]=e[d],a=!0,l=0;l<n.length;l++)(!1&s||r>=s)&&Object.keys(i.O).every((e=>i.O[e](n[l])))?n.splice(l--,1):(a=!1,s<r&&(r=s));if(a){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,o,s]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),i.p="./",(()=>{i.b=document.baseURI||self.location.href;var e={179:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var o,s,[r,a,l]=n,c=0;if(r.some((t=>0!==e[t]))){for(o in a)i.o(a,o)&&(i.m[o]=a[o]);if(l)var d=l(i)}for(t&&t(n);c<r.length;c++)s=r[c],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(d)},n=globalThis.webpackChunkridge_editor=globalThis.webpackChunkridge_editor||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),i.nc=void 0;var o=i.O(void 0,[736],(()=>i(11310)));o=i.O(o)})();